function ActionListener(t){this.cmd=t,this.actions={}}function Autocompletion(t,e,n,i,a){this.form_=t,this.dropdown_=e,this.cmd_=n,this.minChar_=i||2,this.maxProp_=a||10,this.init_()}function BlockNavigator(){}function ContainerZone(t,e,n){this.container=document.getElementById(t),this.ruler=document.getElementById(e),this.title=document.getElementById(n),this.currentLayout=this.Layout.FULL,this.widgets=[],this.populatedWidgets=[],this.initRuler(),this.focus_=0,this.focusListeners=[];var i=this;this.fallback=function(){var t=i.getWidget("New Widget",!1);t.setHTMLContent('<p class="mdl-typography--text-center">Ready !</p>'),i.add(t)}}function write(){var t=prompt("hexpairs, quoted string or :assembly");if(""!=t)switch(t[0]){case":":t=t.substring(1),r2.cmd('"wa '+t+'"',update);break;case'"':t=t.replace(/"/g,""),r2.cmd("w "+t,update);break;default:r2.cmd("wx "+t,update)}}function comment(){var t=prompt("comment");t&&("-"==t?r2.cmd("CC-"):r2.cmd('"CC '+t+'"'),update())}function flag(){var t=prompt("flag");t&&("-"==t?r2.cmd("f"+t):r2.cmd("f "+t),update())}function block(){var t=prompt("block");t&&t.trim()&&(r2.cmd("b "+t),update())}function flagsize(){var t=prompt("size");t&&t.trim()&&(r2.cmd("fl $$ "+t),update())}function analyze(){r2.cmd("af",function(){panelDisasm()})}function notes(){var t=widgetContainer.getWidget("Notes"),e=widgetContainer.getWidgetDOMWrapper(t),n="<br />"+uiButton("javascript:panelComments()","&lt; Comments");n+='<br /><br /><textarea rows=32 style="width:100%;height:100%"></textarea>',e.innerHTML=n}function setFlagspace(t){t||(t=prompt("name")),t&&r2.cmd("fs "+t,function(){flagspaces()})}function renameFlagspace(t){t||(t=prompt("name")),t&&r2.cmd("fsr "+t,function(){flagspaces()})}function delFlagspace(t){t||(t="."),t&&r2.cmd("fs-"+t,function(){flagspaces()})}function delAllFlags(){r2.cmd("f-*",function(){panelFlags()})}function setNullFlagspace(t){updates.registerMethod(widgetContainer.getFocus(),t?panelFlags:flagspaces),r2.cmd("fs *",function(){flagspaces()})}function flagspaces(){var t=widgetContainer.getWidget("Flag Spaces"),e=widgetContainer.getWidgetDOMWrapper(t);updates.registerMethod(t.getOffset(),flagspaces),e.innerHTML="<br />&nbsp;"+uiRoundButton("javascript:panelFlags()","undo"),e.innerHTML+="&nbsp;"+uiButton("javascript:setNullFlagspace()","Deselect"),e.innerHTML+="&nbsp;"+uiButton("javascript:setFlagspace()","Add"),e.innerHTML+="&nbsp;"+uiButton("javascript:delFlagspace()","Delete"),e.innerHTML+="&nbsp;"+uiButton("javascript:renameFlagspace()","Rename"),e.innerHTML+="<br /><br />",r2.cmd("fs",function(t){var n=t.split(/\n/),i=uiTableBegin(["+Flags","Flagspace"]);for(var a in n){var o=n[a].split(/ +/);if(o.length>=4){var s=o[2].indexOf(".")==-1,r="";r+="<a href=\"javascript:setFlagspace('"+o[3]+"')\">",r+=s?"<font color='red'>"+o[3]+"</font>":o[3],r+="</a>",i+=uiTableRow(["+"+o[1],r])}}i+=uiTableEnd(),e.innerHTML+=i})}function analyzeSymbols(){statusMessage("Analyzing symbols..."),r2.cmd("aa",function(){statusMessage("done"),update()})}function analyzeRefs(){statusMessage("Analyzing references..."),r2.cmd("aar",function(){statusMessage("done"),update()})}function analyzeCalls(){statusMessage("Analyzing calls..."),r2.cmd("aac",function(){statusMessage("done"),update()})}function analyzeFunction(){statusMessage("Analyzing function..."),r2.cmd("af",function(){statusMessage("done"),update()})}function analyzeNames(){statusMessage("Analyzing names..."),r2.cmd(".afna @@ fcn.*",function(){statusMessage("done"),update()})}function panelAbout(){r2.cmd("?V",function(t){alert("radare2 material webui by --pancake @ 2015-2016\n\n"+t.trim())})}function panelFunctions(){var t=widgetContainer.getWidget("Functions");t.setDark();var e=widgetContainer.getWidgetDOMWrapper(t);updates.registerMethod(t.getOffset(),function(){}),lastViews.registerMethod(t.getOffset(),panelDisasm),e.style.backgroundColor="#f0f0f0";var n="<br />";n+=uiButton("javascript:analyzeSymbols()","Symbols"),n+=uiButton("javascript:analyzeCalls()","Calls"),n+=uiButton("javascript:analyzeFunction()","Function"),n+=uiButton("javascript:analyzeRefs()","Refs"),n+=uiButton("javascript:analyzeNames()","AutoName"),n+="<br /><br />",e.innerHTML=n,r2.cmd("e scr.utf8=false"),r2.cmd("afl",function(t){var n=new Table(["+Address","Name","+Size","+CC"],[!1,!0,!1,!1],"functionTable"),i=t.split(/\n/);for(var a in i){var o=i[a].match(/^(0x[0-9a-f]+)\s+([0-9]+)\s+([0-9]+(\s+\-&gt;\s+[0-9]+)?)\s+(.+)$/);null!==o&&n.addRow([o[1],o[5],o[2],o[3]])}n.insertInto(e)})}function runCommand(t){t||(t=document.getElementById("input").value),r2.cmd(t,function(t){lastConsoleOutput="\n"+t,document.getElementById("output").innerHTML=lastConsoleOutput})}function searchKey(t){var e=document.getElementById("search_input");t?13==t.keyCode&&(runSearch(e.value),e.value=""):e.onkeypress=searchKey}function runSearchMagic(){r2.cmd("/m",function(t){document.getElementById("search_output").innerHTML=clickableOffsets(t)})}function runSearchCode(t){t||(t=document.getElementById("search_input").value),r2.cmd('"/c '+t+'"',function(t){document.getElementById("search_output").innerHTML=clickableOffsets(t)})}function runSearchString(t){t||(t=document.getElementById("search_input").value),r2.cmd("/ "+t,function(t){document.getElementById("search_output").innerHTML=clickableOffsets(t)})}function runSearchROP(t){t||(t=document.getElementById("search_input").value),r2.cmd('"/R '+t+'"',function(t){document.getElementById("search_output").innerHTML=clickableOffsets(t)})}function runSearch(t){t||(t=document.getElementById("search_input").value),'"'==t[0]?r2.cmd('"/ '+t+'"',function(t){document.getElementById("search_output").innerHTML=clickableOffsets(t)}):r2.cmd('"/x '+t+'"',function(t){document.getElementById("search_output").innerHTML=clickableOffsets(t)})}function indentScript(){var t=document.getElementById("script").value,e=t;document.getElementById("script").value=e,localStorage.script=e}function runScript(){var str=document.getElementById("script").value;localStorage.script=str,document.getElementById("scriptOutput").innerHTML="";try{var msg="\"use strict\";function log(x) { var a = document.getElementById('scriptOutput'); if (a) a.innerHTML += x + '\\n'; }\n";eval(msg+str)}catch(t){alert(t)}}function toggleScriptOutput(){var t=document.getElementById("scriptOutput");t&&(""==foo?(foo=t.innerHTML,t.innerHTML=""):(t.innerHTML=foo,foo=""))}function panelScript(){var t=widgetContainer.getWidget("Script"),e=widgetContainer.getWidgetDOMWrapper(t);updates.registerMethod(t.getOffset(),panelScript),e.style.backgroundColor="#f0f0f0";var n=localStorage.getItem("script"),i="<br />"+uiButton("javascript:runScript()","Run");i+="&nbsp;"+uiButton("javascript:indentScript()","Indent"),i+="&nbsp;"+uiButton("javascript:toggleScriptOutput()","Output"),i+="&nbsp;"+uiButton("javascript:panelConsole()","Console"),i+='<br /><div class="output" id="scriptOutput"></div><br />',i+='<textarea rows=32 id="script" class="pre" style="width:100%">',n||(n='r2.cmd("?V", log);'),i+=n+"</textarea>",e.innerHTML=i}function panelSearch(){var t=widgetContainer.getWidget("Search"),e=widgetContainer.getWidgetDOMWrapper(t);updates.registerMethod(t.getOffset(),panelSearch),e.style.backgroundColor="#f0f0f0";var n="background-color:white !important;padding-left:10px;top:3.5em;height:1.8em;color:white",i="mdl-card--expand mdl-textfield__input",a="<br />";a+="<input style='"+n+"' onkeypress='searchKey()' class='"+i+"' id='search_input'/>",a+="<br />",a+=uiButton("javascript:runSearch()","Hex"),a+=uiButton("javascript:runSearchString()","String"),a+=uiButton("javascript:runSearchCode()","Code"),a+=uiButton("javascript:runSearchROP()","ROP"),a+=uiButton("javascript:runSearchMagic()","Magic"),a+="<br /><br />",a+="<div id='search_output' class='pre' style='color:black!important'><div>",e.innerHTML=a}function panelFlags(){var t=widgetContainer.getWidget("Flags"),e=widgetContainer.getWidgetDOMWrapper(t);updates.registerMethod(t.getOffset(),function(){}),lastViews.registerMethod(t.getOffset(),panelDisasm),e.style.backgroundColor="#f0f0f0",e.innerHTML="<br />",e.innerHTML+=uiButton("javascript:flagspaces()","Spaces"),e.innerHTML+=uiButton("javascript:delAllFlags()","DeleteAll"),e.innerHTML+="<br /><br />",r2.cmd("f",function(t){var n=new Table(["+Offset","+Size","Name"],[!0,!0,!1],"flagsTable"),i=t.split(/\n/);for(var a in i){var o=i[a].split(/ /);o.length>=3&&n.addRow([o[0],o[1],o[2]])}n.insertInto(e)})}function up(){r2.cmd("s--"),update()}function down(){r2.cmd("s++"),update()}function srpc(){r2.cmd("sr pc",update)}function stepi(){nativeDebugger?r2.cmd("ds",update):r2.cmd("aes",update)}function cont(){nativeDebugger?r2.cmd("dc",update):r2.cmd("aec",update)}function setbp(){r2.cmd("db $$",update)}function setreg(){var t=prompt("register=value");""!=t&&(nativeDebugger?r2.cmd("dr "+t+";.dr*",update):r2.cmd("aer "+t+";.ar*",update))}function panelDebug(){r2.cmd("e cfg.debug",function(t){nativeDebugger="true"==t.trim()});var t=widgetContainer.getWidget("Debugger"),e=widgetContainer.getWidgetDOMWrapper(t);updates.registerMethod(t.getOffset(),panelDebug),lastViews.registerMethod(t.getOffset(),function(){}),inColor&&(e.style.backgroundColor="#202020");var n="<div style='position:fixed;margin:0.5em'>";n+=uiRoundButton("javascript:up()","keyboard_arrow_up"),n+=uiRoundButton("javascript:down()","keyboard_arrow_down"),n+="&nbsp;",n+=uiButton("javascript:srpc()","PC"),n+=uiButton("javascript:stepi()","Step"),n+=uiButton("javascript:cont()","Cont"),n+=uiButton("javascript:setbp()","BP"),n+=uiButton("javascript:setreg()","REG"),n+="</div><br /><br /><br /><br />",e.innerHTML=n;var i="";if(inColor&&(i="@e:scr.color=1,scr.html=1"),nativeDebugger)var a="dr";else var a="ar";r2.cmd("f cur;."+a+"*;sr sp;px 64",function(t){var n=clickableOffsets(t);e.innerHTML+="<pre style='margin:10px;color:grey'>"+n+"<pre>"}),r2.cmd(a+"=;s cur;f-cur;pd 128"+i,function(t){var n=clickableOffsets(t);e.innerHTML+="<pre style='color:grey'>"+n+"<pre>"})}function saveProject(){r2.cmd("Ps",function(){alert("Project saved")})}function deleteProject(){alert("Project deleted"),location.href="open.html"}function closeProject(){alert("Project closed"),location.href="open.html"}function rename(){var t=prompt("name");t&&""!=t.trim()&&(r2.cmd("afn "+t),r2.cmd("f "+t),update())}function info(){var t=widgetContainer.getWidget("Info");t.setDark();var e=widgetContainer.getWidgetDOMWrapper(t),n=inColor?"white":"black",i="<br />";i+=uiRoundButton("javascript:panelDisasm()","undo"),i+="&nbsp;",i+=uiButton("javascript:pdtext()","Full"),i+=uiButton("javascript:pdf()","Func"),i+=uiButton("javascript:graph()","Graph"),i+=uiButton("javascript:blocks()","Blocks"),i+=uiButton("javascript:decompile()","Decompile"),e.innerHTML=i,r2.cmd("afi",function(t){e.innerHTML+="<pre style='color:"+n+"'>"+t+"<pre>"})}function blocks(){var t=widgetContainer.getWidget("Blocks"),e=widgetContainer.getWidgetDOMWrapper(t);e.style.overflow="none";var n=inColor?"white":"black",i="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-fixed";e.innerHTML="<br />",e.innerHTML+='&nbsp;<a href="javascript:panelDisasm()" class="'+i+'">&lt; INFO</a> <h3 color=white></h3>';var a=inColor?"@e:scr.color=1,scr.html=1":"";r2.cmd("pdr"+a,function(t){e.innerHTML+="<pre style='color:"+n+"'>"+t+"<pre>"})}function pdtext(){var t=widgetContainer.getWidget("Function"),e=widgetContainer.getWidgetDOMWrapper(t);e.style.overflow="none";var n=inColor?"white":"black",i="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-fixed";e.innerHTML="<br />",e.innerHTML+='&nbsp;<a href="javascript:panelDisasm()" class="'+i+'">&lt; INFO</a> <h3 color=white></h3>';r2.cmd("e scr.color=1;s entry0;s $S;pD $SS;e scr.color=0",function(t){t=clickableOffsets(t),e.innerHTML+="<pre style='color:"+n+"'>"+t+"<pre>"})}function pdf(){var t=widgetContainer.getWidget("Function"),e=widgetContainer.getWidgetDOMWrapper(t);e.style.overflow="none";var n=inColor?"white":"black",i="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect ";i+="mdl-color--accent mdl-color-text--accent-contrast",e.innerHTML="<br />",e.innerHTML+='&nbsp;<a href="javascript:panelDisasm()" class="'+i+'">&lt; INFO</a> <h3 color=white></h3>';var a=inColor?"@e:scr.color=1,scr.html=1,asm.lineswidth=0":"@e:asm.lineswidth=0";r2.cmd("pdf"+a,function(t){e.innerHTML+="<pre style='color:"+n+"'>"+t+"<pre>"})}function decompile(){var t=widgetContainer.getWidget("Decompile"),e=widgetContainer.getWidgetDOMWrapper(t);e.style.overflow="none";var n=inColor?"white":"black",i="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect ";i+="mdl-color--accent mdl-color-text--accent-contrast",e.innerHTML="<br />",e.innerHTML+='&nbsp;<a href="javascript:panelDisasm()" class="'+i+'">&lt; INFO</a> <h3 color=white></h3>';var a=inColor?"@e:scr.color=1,scr.html=1":"";r2.cmd("pdc"+a,function(t){e.innerHTML+="<pre style='color:"+n+"'>"+t+"<pre>"})}function graph(){var t=widgetContainer.getWidget("Graph"),e=widgetContainer.getWidgetDOMWrapper(t);t.setDark(),e.setAttribute("content","user-scalable=yes, width=device-width, minimum-scale=1, maximum-scale=1"),e.style.overflow="auto";var n=inColor?"white":"black",i="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect ";e.innerHTML='<br />&nbsp;<a style="position:fixed;padding-left:10px;top:4em" href="javascript:panelDisasm()" class="'+i+'">&lt; DISASM</a>';var a=inColor?"@e:scr.color=1,scr.html=1":"";r2.cmd("agf"+a,function(t){t=clickableOffsets(t),e.innerHTML+="<pre style='color:"+n+"'>"+t+"<pre>"})}function onClick(t,e){var n=document.getElementById(t);n?n.addEventListener("click",function(){e()}):console.error("onclick-error",t)}function panelHelp(){alert("TODO")}function analyzeButton(){function t(){updateFortune(),updateInfo(),updateEntropy()}E("anal_calls").checked?r2.cmd("e anal.calls=true;aac",t):r2.cmd("e anal.calls=false"),E("anal_prelude").checked&&r2.cmd("aap",t),E("anal_emu").checked?r2.cmd("e asm.emu=1;aae;e asm.emu=0",t):r2.cmd("e asm.emu=false"),E("anal_autoname").checked&&r2.cmd("aan",t),E("anal_symbols").checked&&r2.cmd("aa",t)}function ready(){if(!twice){twice=!0,applyConf(),updates=new UpdateManager,lastViews=new UpdateManager,widgetContainer=new ContainerZone("content","ruler","title"),widgetContainer.fallbackWidget(panelDisasm),widgetContainer.addFocusListener(updates),widgetContainer.addFocusListener(lastViews),update=function(){updates.apply()},lastView=function(){lastViews.apply()},panelOverview(),onClick("analyze_button",analyzeButton),onClick("menu_overview",panelOverview),onClick("menu_disasm",panelDisasm),onClick("menu_debug",panelDebug),onClick("menu_hexdump",panelHexdump),onClick("menu_functions",panelFunctions),onClick("menu_flags",panelFlags),onClick("menu_search",panelSearch),onClick("menu_comments",panelComments),onClick("menu_script",panelScript),onClick("menu_help",panelHelp),onClick("menu_project_save",saveProject),onClick("menu_project_delete",deleteProject),onClick("menu_project_close",closeProject),onClick("menu_seek",seek),onClick("menu_settings",panelSettings),onClick("menu_about",panelAbout),onClick("menu_mail",function(){window.location="mailto:pancake@nopcode.org"});var t=new Autocompletion("search","search_autocomplete","fs *;fj");t.setPrepareView(function(){widgetContainer.isSplitted()||widgetContainer.split(widgetContainer.Layout.VERTICAL),disasm.draw()}),document.querySelector(".mdl-layout__drawer").addEventListener("click",function(){document.querySelector(".mdl-layout__obfuscator").classList.remove("is-visible"),this.classList.remove("is-visible")},!1)}}function RadareInfiniteBlock(){}function setStatusbarBody(){function t(t,e){var n=document.createElement(t);return n.id=e,n.className=e,n}var e;try{var n=document.getElementById("tab_terminal");n.innerHTML="",n.parentNode.removeChild(n)}catch(t){}try{var n=document.getElementById("tab_logs");n.innerHTML="",n.parentNode.removeChild(n)}catch(t){}switch(statusTab){case Tab.LOGS:var i=new DOMParser,e=document.createElement("div");e.id="tab_logs";var a=statusLog.join("<br />");e.appendChild(i.parseFromString(a,"text/xml").documentElement);var n=document.getElementById("statusbar_body");try{n.parentNode.insertBefore(e,n)}catch(t){}return void console.log(n);case Tab.CONSOLE:var e=document.createElement("div");e.id="tab_terminal",e.appendChild(t("div","terminal")),e.appendChild(t("div","terminal_output"));var o=t("div","terminal_prompt");o.appendChild(t("input","terminal_input")),e.appendChild(o)}if(void 0!==e){var n=document.getElementById("statusbar"),s=document.getElementById("terminal");s||(n.parentNode.insertBefore(e,n),statusTab===Tab.CONSOLE&&terminal_ready())}}function statusMessage(t,e){var n=document.getElementById("statusbar");t&&statusLog.push(t),statusMode===Mode.LINE?(n.innerHTML=t,null!==statusTimeout&&(clearTimeout(statusTimeout),statusTimeout=null),void 0!==e&&(statusTimeout=setTimeout(function(){statusMessage("&nbsp;")},1e3*e))):setStatusbarBody()}function statusToggle(){var t=document.getElementById("statusbar"),e=document.getElementById("container");if(statusMode==Mode.HALF){statusTab=Tab.LOGS,statusMode=Mode.LINE,t.innerHTML="&nbsp;";try{t.parentNode.classList.remove("half"),t.parentNode.classList.remove("full"),e.classList.remove("sbIsHalf"),e.classList.remove("sbIsFull")}catch(t){}setStatusbarBody()}else{statusMode=Mode.HALF;try{t.parentNode.classList.remove("full"),e.classList.remove("sbIsFull")}catch(t){}t.parentNode.classList.add("half"),e.classList.add("sbIsHalf")}}function statusNext(){var t=document.getElementById("statusbar"),e=document.getElementById("container");switch(statusMode){case Mode.LINE:statusMode=Mode.HALF;try{t.parentNode.classList.remove("full"),e.classList.remove("sbIsFull")}catch(t){}t.parentNode.classList.add("half"),e.classList.add("sbIsHalf");break;case Mode.HALF:return statusMode=Mode.FULL,t.parentNode.classList.add("full"),void e.classList.add("sbIsFull");case Mode.FULL:statusMode=Mode.LINE,statusTab=Tab.LOGS,t.innerHTML="";try{var t=document.getElementById("statusbar"),e=document.getElementById("container");t.parentNode.classList.remove("half"),t.parentNode.classList.remove("full"),e.classList.remove("sbIsHalf"),e.classList.remove("sbIsFull")}catch(t){}}setStatusbarBody()}function statusConsole(){var t=document.getElementById("statusbar"),e=document.getElementById("container");if(statusTab===Tab.CONSOLE){if(statusMode!==Mode.LINE)return statusToggle(),void(statusMode=Mode.LINE);statusTab=Tab.CONSOLE}if(statusMode===Mode.HALF)statusMode=Mode.LINE;else if(statusMode===Mode.LINE){statusTab=Mode.CONSOLE,statusMode=Mode.HALF;try{t.parentNode.classList.remove("full"),e.classList.remove("sbIsFull")}catch(t){}try{t.parentNode.classList.add("half"),e.classList.add("sbIsHalf")}catch(t){}}statusTab=statusTab==Tab.CONSOLE?Tab.LOGS:Tab.CONSOLE,setStatusbarBody()}function statusFullscreen(){var t=document.getElementById("statusbar"),e=document.getElementById("container");if(statusMode==Mode.FULL){statusMode=Mode.HALF;try{t.parentNode.classList.remove("full"),e.classList.remove("sbIsFull")}catch(t){}t.parentNode.classList.add("half"),e.classList.add("sbIsHalf")}else{statusMode=Mode.FULL;try{t.parentNode.classList.remove("half"),e.classList.remove("sbIsHalf")}catch(t){}t.parentNode.classList.add("full"),e.classList.add("sbIsFull")}}function addButton(t,e){var n=document.createElement("a");return n.href="javascript:"+e+"()",n.innerHTML=t,n}function initializeStatusbarTitle(){return}function statusInitialize(){initializeStatusbarTitle();var t=document.getElementById("statusbar");t.innerHTML="",t.parentNode.addEventListener("click",function(){statusMode==Mode.LINE&&(statusTab=Tab.CONSOLE,statusToggle())}),statusMessage("Loading webui...",2)}function submit(t){var e=document.getElementById("terminal_output"),n=document.getElementById("terminal_input");return n&&e?"clear"===t?(e.innerHTML="",void(n.value="")):void r2.cmd(t,function(i){i+="\n",e.innerHTML+=" > "+t+"\n"+i,n.value="";var a=document.getElementById("statusbar_scroll");a.scrollTop=a.scrollHeight}):void console.error("No terminal_{input|output} found")}function terminal_ready(){r2.cmd("e scr.color=true");var t=document.getElementById("terminal_input");return t?(t.focus(),void(t.onkeypress=function(e){13==e.keyCode&&submit(t.value)})):void console.error("Cannot find terminal_input")}function E(t){return document.getElementById(t)}function encode(t){return t.replace(/[\x26\x0A\<>'"]/g,function(t){return"&#"+t.charCodeAt(0)+";"})}function clickableOffsets(t){return t=t.replace(/0x([a-zA-Z0-9]*)/g,"<a href='javascript:seek(\"0x$1\")'>0x$1</a>"),t=t.replace(/sym\.([\.a-zA-Z0-9_]*)/g,"<a href='javascript:seek(\"sym.$1\")'>sym.$1</a>"),t=t.replace(/fcn\.([\.a-zA-Z0-9_]*)/g,"<a href='javascript:seek(\"fcn.$1\")'>fcn.$1</a>"),t=t.replace(/str\.([\.a-zA-Z0-9_]*)/g,"<a href='javascript:seek(\"str.$1\")'>str.$1</a>")}function uiButton(t,e,n){var i="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect ";if("active"==n){var a='style="background-color:#f04040 !important"';return'&nbsp;<a href="'+t.replace(/"/g,"'")+'" class="'+i+'" '+a+">"+e+"</a>"}return'&nbsp;<a href="'+t.replace(/"/g,"'")+'" class="'+i+'">'+e+"</a>"}function uiCheckList(t,e,n){var i="<li>";return ouput+='<label for="'+t+'" class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect">',ouput+='<input type="checkbox" id="'+e+'" class="mdl-checkbox__input" />',ouput+='<span class="mdl-checkbox__label">'+n+"</span>",ouput+="</label></li>",i}function uiCombo(d){var funName="combo"+ ++comboId,fun=funName+" = function(e) {";fun+=' var sel = document.getElementById("opt_'+funName+'");',fun+=" var opt = sel.options[sel.selectedIndex].value;",fun+=" switch (opt) {";for(var a in d)fun+='case "'+d[a].name+'": '+d[a].js+"("+d[a].name+");break;";fun+="}}",eval(fun);var out='<select id="opt_'+funName+'" onchange="'+funName+'()">';for(var a in d){var def=d[a].default?" default":"";out+="<option"+def+">"+d[a].name+"</option>"}return out+="</select>"}function uiSwitch(t,e,n,i){var a="switch-"+ ++idSwitch,o=document.createElement("label");o.className="mdl-switch mdl-js-switch mdl-js-ripple-effect",o.for=a,t.appendChild(o);var s=document.createElement("input");s.type="checkbox",s.className="mdl-switch__input",s.checked=n,s.id=a,o.appendChild(s),s.addEventListener("change",function(t){i(e,t.target.checked)});var r=document.createElement("span");r.className="mdl-switch__label",r.innerHTML=e,o.appendChild(r);var l=document.createElement("br");o.appendChild(l)}function uiActionButton(t,e,n){var i=document.createElement("a");i.href="#",i.innerHTML=n,i.addEventListener("click",e),t.appendChild(i);var a="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect ";a+="mdl-color--accent mdl-color-text--accent-contrast",i.className=a,i.style.margin="3px"}function uiSelect(t,e,n,i,a){var o="select-"+ ++selectId,s=document.createElement("div");s.className="mdl-selectfield mdl-js-selectfield mdl-selectfield--floating-label",t.appendChild(s);var r=document.createElement("select");r.className="mdl-selectfield__select",r.id=o,r.name=o,s.appendChild(r);for(var l=0;l<n.length;l++){var c=document.createElement("option");c.innerHTML=n[l],c.value=n[l],r.appendChild(c),l===i&&(c.selected=!0)}r.addEventListener("change",function(t){a(t.target.value)});var d=document.createElement("label");d.className="mdl-selectfield__label",d.for=o,d.innerHTML=e,s.appendChild(d)}function uiBlock(t){var e="";for(var n in t.blocks){var i=t.blocks[n];e+="<br />"+i.name+": ",e+=uiCombo(i.buttons)}return e}function uiRoundButton(t,e,n){var i="";return i+="<button onclick="+t+' class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect" '+n+">",i+='<i class="material-icons" style="opacity:1">'+e+"</i>",i+="</button>"}function Table(t,e,n,i){this.cols=t,this.nonum=e,this.clickableOffset=new Array(t.length),this.clickableOffset.fill(!1),this.contentEditable=new Array(t.length),this.contentEditable.fill(!1),this.onChange=i,this.id=n||!1,this.init()}function uiTableBegin(t,e){var n="",i=e||"",a="mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp";n+='<table id="'+i.substr(1)+'" style="margin-left:10px" class="'+a+'">',n+="  <thead> <tr>";var o;for(var s in t){var r=t[s];"+"==r[0]?(r=r.substring(1),o=""):o=' class="mdl-data-table__cell--non-numeric"',n+="<th"+o+">"+r+"</th>"}return n+="</tr> </thead> <tbody>"}function uiTableRow(t){var e="<tr>";for(var n in t){var i=t[n];i&&("+"==i[0]?(i=clickableOffsets(i.substring(1)),type=""):type=' class="mdl-data-table__cell--non-numeric"',e+="<td"+type+">"+i+"</td>")}return e+"</tr>"}function uiTableEnd(){return"</tbody> </table>"}function UpdateManager(){this.updateMethods=[{},{}],this.currentFocus=void 0}function Widget(t,e){this.name=t,this.identifier=e,"undefined"!=typeof e&&(this.DOMWrapper=document.getElementById(e))}function Disasm(t,e){this.container=new FlexContainer(t,"disasm"),this.lineHeight=e,this.refreshInitialOffset(),this.init(),this.offsetHistory=["0x"+this.initialOffset.toString(16)],this.indexOffsetHistory=0;var n=this;seekAction.registerLocalAction("Disassembly",function(t){for(var e=n.offsetHistory.length-1-n.indexOffsetHistory,i=0;i<e;i++)n.offsetHistory.pop();n.offsetHistory.push(t),n.indexOffsetHistory=n.offsetHistory.length-1,n.drawControls(n.container.getControls())})}function DisasmNavigator(t,e){this.currentOffset=e,this.howManyLines=t,this.gap=2*this.howManyLines,this.providerWorker=new Worker("disasmProvider.js"),this.optimalLines=3*this.howManyLines,this.MINFILL=.8*this.optimalLines,this.items=[],this.init()}function Hexdump(t,e,n){this.container=new FlexContainer(t,"hex"),this.lineHeight=e,this.bigEndian=n,this.nbColumns=16,this.hexLength=this.Sizes.PAIRS,this.init(),this.resetContainer(t),this.showFlags=!0,this.beingSelected=!1,this.selectionFirst,this.selectionEnd,this.lastColorUsed=-1,this.bgColors=["rgba(255,0,0,0.4)","rgba(0,255,0,0.4)","rgba(0,92,192,0.4)","rgba(255,255,0,0.4)","rgba(255,0,255,0.4)","rgba(0,255,255,0.4)"],this.flagColorAssociation=[]}function HexPairNavigator(t,e,n){this.howManyBytes=16*t,this.gap=this.howManyBytes,this.currentOffset=n,this.curChunk=void 0,this.providerWorker=new Worker("hexchunkProvider.js"),this.providerWorker.postMessage({howManyBytes:this.howManyBytes,nbCols:e}),this.init()}function hexPairToASCII(t){var e=parseInt(t,16);return e>=33&&e<=126?String.fromCharCode(e):"."}function ASCIIToHexpair(t){var e=t.charCodeAt(0).toString(16);return e.length<2&&(e="0"+e),e}function isAsciiVisible(t){return t>=33&&t<=126}function basename(t){return t.split(/[\\\/]/).pop()}function int2fixedHex(t,e){for(var n=t.toString(16);n.length<e;)n="0"+n;return"0x"+n}function console_submit(t){var e=(document.getElementById("console_terminal"),document.getElementById("console_output")),n=document.getElementById("console_input"),i=widgetContainer.getWidget("Console");widgetContainer.getWidgetDOMWrapper(i);return"clear"===t?(e.innerHTML="",void(n.value="")):void r2.cmd(t,function(i){e.innerHTML+=" > "+t+"\n"+i,n.value="",setTimeout(function(){window.scrollTo("console_input")},1e3)})}function console_ready(){var t=document.getElementById("console_input");null!==t&&(r2.cmd("e scr.color=true"),t.focus(),t.onkeypress=function(e){13==e.keyCode&&console_submit(t.value)})}function consoleKey(t){var e=document.getElementById("console_input");t?13==t.keyCode&&(runCommand(e.value),e.value=""):e.onkeypress=consoleKey}function panelConsole(){var t=widgetContainer.getWidget("Console"),e=widgetContainer.getWidgetDOMWrapper(t);updates.registerMethod(t.getOffset(),panelConsole);const n='<br /><div id="console_terminal" class="console_terminal"><div id="console_output" class=console_output></div><div id="console_prompt" class=console_prompt>&nbsp;&gt;&nbsp;<input name="console_input" class="console_input" id="console_input"></input></div></div><br /><br />';e.innerHTML=n,e.style.backgroundColor="#303030",e.style.height="100%",document.getElementById("console_output").innerHTML=lastConsoleOutput,console_ready()}function FlexContainer(t,e){this.classes="undefined"==typeof e?"":e,this.init(t)}function InfiniteScrolling(t,e,n){this.domTarget=t,this.limit=n,this.howManyScreens=e,this.screenProportion=1/this.howManyScreens,this.pauseScrollEvent=!1,this.prevScroll=0;var i=this;this.domTarget.addEventListener("scroll",function(t){i.scrollEvent_(t)})}function panelComments(){var t=widgetContainer.getWidget("Comments"),e=widgetContainer.getWidgetDOMWrapper(t);lastViews.registerMethod(t.getOffset(),panelDisasm),updates.registerMethod(t.getOffset(),function(){}),e.style.backgroundColor="#f0f0f0",e.innerHTML="<br />",e.innerHTML+=uiButton("javascript:notes()","Notes"),e.innerHTML+="<br /><br />",r2.cmd("CC",function(t){var n=new Table(["+Offset","~Comment"],[!0,!1],"commentsTable",function(t,e){var n=t[0];r2.cmd("CC- @ "+n),r2.cmd("CCu base64:"+window.btoa(e)+" @ "+n),update()}),i=t.split(/\n/);for(var a in i){var o=i[a].split(/ (.+)?/);o.length>=2&&n.addRow([o[0],o[1]])}n.insertInto(e)})}function panelDisasm(){var t=widgetContainer.getWidget("Disassembly"),e=widgetContainer.getWidgetDOMWrapper(t);e.classList.add("disasmPanel"),"undefined"==typeof disasm?disasm=new Disasm(e,24):disasm.resetContainer(e),disasm.draw(),t.setDark();var n=function(){disasm.refreshInitialOffset(),disasm.resetContainer(e),disasm.draw(),t.setDark()};updates.registerMethod(t.getOffset(),function(){}),lastViews.registerMethod(t.getOffset(),n)}function panelHexdump(){var t=widgetContainer.getWidget("Hexdump"),e=widgetContainer.getWidgetDOMWrapper(t);if(e.classList.add("hexdump"),"undefined"==typeof hexdump){var n;r2.cmd("e cfg.bigendian",function(t){n="true"==t}),hexdump=new Hexdump(e,24,n),hexdump.setOnChangeCallback(function(t,e,n){console.log("changed")})}else hexdump.resetContainer(e);hexdump.draw(),t.setDark();var i=function(){hexdump.refreshInitialOffset(),hexdump.resetContainer(e),hexdump.draw(),t.setDark()};updates.registerMethod(t.getOffset(),function(){}),lastViews.registerMethod(t.getOffset(),i)}function panelOverview(){var t=widgetContainer.getWidget("Overview"),e=widgetContainer.getWidgetDOMWrapper(t);lastViews.registerMethod(t.getOffset(),panelDisasm),updates.registerMethod(t.getOffset(),function(){});var n='<div class="mdl-grid demo-content">';n+='<div class="demo-graphs mdl-shadow--2dp mdl-color--white mdl-cell mdl-cell--8-col" id="info-cell" height="100%">',n+='\t<div class="mdl-tabs mdl-js-tabs">',n+='\t\t<div class="mdl-tabs__tab-bar" id="overview-tabs" style="margin-left:-30px;margin-top:-20px;margin-right:-30px">',n+='\t\t\t<a href="#tab-info" class="mdl-tabs__tab is-active">Hdr</a>',n+='\t\t\t<a href="#tab-symbols" class="mdl-tabs__tab" onclick="overviewLoad(this, headersCmd.symbols)">Sym</a>',n+='\t\t\t<a href="#tab-imports" class="mdl-tabs__tab" onclick="overviewLoad(this, headersCmd.imports)">Imp</a>',n+='\t\t\t<a href="#tab-relocs" class="mdl-tabs__tab" onclick="overviewLoad(this, headersCmd.relocs)">Rel</a>',n+='\t\t\t<a href="#tab-sections" class="mdl-tabs__tab" onclick="overviewLoad(this, headersCmd.sections)">Sec</a>',n+='\t\t\t<a href="#tab-strings" class="mdl-tabs__tab" onclick="overviewLoad(this, headersCmd.strings)">Str</a>',n+='\t\t\t<a href="#tab-sdb" class="mdl-tabs__tab" onclick="overviewLoad(this, headersCmd.sdb)">SDB</a>',n+="\t\t</div>",n+='\t\t<div id="overview-content">',n+='\t\t\t<div class="mdl-tabs__panel is-active" id="tab-info"></div>',n+='\t\t\t<div class="mdl-tabs__panel" id="tab-symbols"></div>',n+='\t\t\t<div class="mdl-tabs__panel" id="tab-infos"></div>',n+='\t\t\t<div class="mdl-tabs__panel" id="tab-imports"></div>',n+='\t\t\t<div class="mdl-tabs__panel" id="tab-relocs"></div>',n+='\t\t\t<div class="mdl-tabs__panel" id="tab-sections"></div>',n+='\t\t\t<div class="mdl-tabs__panel" id="tab-strings"></div>',n+='\t\t\t<div class="mdl-tabs__panel" id="tab-sdb"></div>',n+="\t\t</div>",n+="\t</div>",n+="</div>",n+='<div class="demo-cards mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-grid mdl-grid--no-spacing">',
n+='\t<div class="demo-options mdl-card mdl-color--teal-300 mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--3-col-tablet mdl-cell--12-col-desktop">',n+='\t\t<div class="mdl-card__supporting-text mdl-color-grey-600">',n+='\t\t<div class="mdl-card__title mdl-card--expand mdl-color--teal-300">',n+='\t\t\t<h2 class="mdl-card__title-text">Analysis Options</h2>',n+="\t\t</div>",n+="\t\t\t<ul>",n+="\t\t\t\t<li>",n+='\t\t\t\t\t<label for="anal_symbols" class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect">',n+='\t\t\t\t\t\t<input type="checkbox" id="anal_symbols" class="mdl-checkbox__input" />',n+='\t\t\t\t\t\t<span id="anal_symbols" class="mdl-checkbox__label">Analyze symbols</span>',n+="\t\t\t\t\t</label>",n+="\t\t\t\t</li>",n+="\t\t\t\t<li>",n+='\t\t\t\t\t<label for="anal_calls" class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect">',n+='\t\t\t\t\t\t<input id="anal_calls" type="checkbox" class="mdl-checkbox__input" />',n+='\t\t\t\t\t\t<span class="mdl-checkbox__label">Analyze calls</span>',n+="\t\t\t\t\t</label>",n+="\t\t\t\t</li>",n+="\t\t\t\t<li>",n+='\t\t\t\t\t<label for="anal_emu" class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect">',n+='\t\t\t\t\t\t<input id="anal_emu" type="checkbox" class="mdl-checkbox__input" />',n+='\t\t\t\t\t\t<span class="mdl-checkbox__label">Emulate code</span>',n+="\t\t\t\t\t</label>",n+="\t\t\t\t</li>",n+="\t\t\t\t<li>",n+='\t\t\t\t\t<label for="anal_prelude" class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect">',n+='\t\t\t\t\t\t<input id="anal_prelude" type="checkbox" class="mdl-checkbox__input" />',n+='\t\t\t\t\t\t<span class="mdl-checkbox__label">Find preludes</span>',n+="\t\t\t\t\t</label>",n+="\t\t\t\t</li>",n+="\t\t\t\t<li>",n+='\t\t\t\t\t<label for="anal_autoname" class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect">',n+='\t\t\t\t\t\t<input type="checkbox" id="anal_autoname" class="mdl-checkbox__input" />',n+='\t\t\t\t\t\t<span id="anal_autoname" class="mdl-checkbox__label">Autoname fcns</span>',n+="\t\t\t\t\t</label>",n+="\t\t\t\t</li>",n+="\t\t\t</ul>",n+="\t\t</div>",n+='\t\t<div class="mdl-card__actions mdl-card--border">',n+='\t\t\t<a href="#" id="analyze_button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-color--blue-grey-50 mdl-color-text--blue-greu-50">Analyze</a>',n+='\t\t\t<div class="mdl-layout-spacer"></div>',n+='\t\t\t<i class="material-icons">room</i>',n+="\t\t</div>",n+="\t</div>",n+='\t<div class="demo-separator mdl-cell--1-col"></div>',n+='\t<div class="demo-updates mdl-card mdl-shadow--2dp mdl-cell mdl-cell--4-col mdl-cell--4-col-tablet mdl-cell--12-col-desktop">',n+='\t\t<div class="mdl-card__title mdl-card--expand mdl-color--teal-300">',n+='\t\t\t<h2 class="mdl-card__title-text">Fortunes</h2>',n+="\t\t</div>",n+='\t\t<div class="mdl-card__supporting-text mdl-color-text--grey-600" id="fortune">',n+="\t\t\tAlways use r2 from git",n+="\t\t</div>",n+='\t\t<div class="mdl-card__actions mdl-card--border">',n+='\t\t\t<a href="javascript:updateFortune()" class="mdl-button mdl-js-button mdl-js-ripple-effect">Next</a>',n+="\t\t</div>",n+="\t</div>",n+="</div>",n+='<div class="demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">',n+="\t<h3>Entropy</h3>",n+='\t<svg fill="currentColor" viewBox="0 0 500 80" id="entropy-graph"></svg>',n+="</div>",n+='<div class="demo-charts mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid">',n+='\t<svg fill="currentColor" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop clickable" onclick="panelDisasm();seek(\'entry0\');" title="Go to disassembly">',n+='\t\t<use xlink:href="#piechart" mask="url(#piemask)" />',n+='\t\t<text x="0.3" y="0.2" font-family="Roboto" font-size="0.1" fill="#888" text-anchor="top" dy="0.1">code</text>',n+='\t\t<text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">82<tspan font-size="0.2" dy="-0.07">%</tspan></text>',n+="\t</svg>",n+='\t<svg fill="currentColor" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop clickable" onclick="panelHexdump();seek(\'0x00\');" title="Go to hexdump">',n+='\t\t<use xlink:href="#piechart2" mask="url(#piemask)" />',n+='\t\t<text x="0.3" y="0.2" font-family="Roboto" font-size="0.1" fill="#888" text-anchor="top" dy="0.1">data</text>',n+='\t\t<text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">22<tspan dy="-0.07" font-size="0.2">%</tspan></text>',n+="\t</svg>",n+='\t<svg fill="currentColor" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop clickable" onclick="panelStrings()" title="Go to strings">',n+='\t\t<use xlink:href="#piechart" mask="url(#piemask)" />',n+='\t\t<text x="0.3" y="0.2" font-family="Roboto" font-size="0.1" fill="#888" text-anchor="top" dy="0.1">strings</text>',n+='\t\t<text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">4<tspan dy="-0.07" font-size="0.2">%</tspan></text>',n+="\t</svg>",n+='\t<svg fill="currentColor" width="200px" height="200px" viewBox="0 0 1 1" class="demo-chart mdl-cell mdl-cell--4-col mdl-cell--3-col-desktop clickable" onclick="panelFunctions()" title="Go to functions">',n+='\t\t<use xlink:href="#piechart" mask="url(#piemask)" />',n+='\t\t<text x="0.3" y="0.2" font-family="Roboto" font-size="0.1" fill="#888" text-anchor="top" dy="0.1">functions</text>',n+='\t\t<text x="0.5" y="0.5" font-family="Roboto" font-size="0.3" fill="#888" text-anchor="middle" dy="0.1">82<tspan dy="-0.07" font-size="0.2">%</tspan></text>',n+="\t</svg>",n+="</div>",n+="</div>",e.innerHTML=n,updateFortune(),updateInfo(),updateEntropy(),componentHandler.upgradeDom();var i=document.getElementById("info-cell").getBoundingClientRect().height,a=document.getElementById("overview-content");a.style.height=i-document.getElementById("overview-tabs").getBoundingClientRect().height+"px",a.style.overflow="auto"}function updateFortune(){r2.cmd("fo",function(t){document.getElementById("fortune").innerHTML=t,readFortune()})}function speak(t,e){if("undefined"!=typeof SpeechSynthesisUtterance){var n=new SpeechSynthesisUtterance;n.text=t,n.lang="en-US",n.onend=function(){e&&e()},n.onerror=function(t){e&&e(t)},speechSynthesis.speak(n)}}function readFortune(){var t=document.getElementById("fortune").innerHTML;R2Conf.useTTS.value===!1||speak(t)}function updateInfo(){r2.cmd("i",function(t){var e=t.split(/\n/g),n=e.slice(0,e.length/2),i=e.slice(e.length/2),a="";a+="<br /><br/>",a+="<table style='width:100%'><tr><td style=\"vertical-align:top\">";for(var o in n){var s=n[o].split(/ (.+)?/);s.length>=2&&(a+="<b>"+s[0]+"</b> "+s[1]+"<br/>")}a+="</td><td>";for(var o in i){var s=i[o].split(/ (.+)?/);s.length>=2&&(a+="<b>"+s[0]+"</b> "+s[1]+"<br/>")}a+="</td></tr></table>",document.getElementById("tab-info").innerHTML=a})}function updateEntropy(){var t=document.getElementById("entropy-graph"),e=t.viewBox.baseVal.height,n=(0|e)-19;r2.cmd("p=ej 50 $s @ $M",function(e){var i="",a=JSON.parse(e),o=new Array;for(var s in a.entropy)o.push(a.entropy[s].value);var r=o.length,l=Math.min.apply(null,o),c=Math.max.apply(null,o),d=500/r;for(var s in o){var u=.1+.9*((o[s]-l)/(c-l)),p="0x"+a.entropy[s].addr.toString(16);i+='<rect x="'+(d*s).toString(),i+='" y="0" width="'+d.toString(),i+='" height="'+n+'" style="fill:black;fill-opacity:',i+=u.toString()+';"><title>',i+=p+" </title></rect>",s%8==0&&(i+='<text transform="matrix(1 0 0 1 ',i+=(s*d).toString(),i+=" "+(n+15)+')" fill="ff8888" font-family="\'Roboto\'" font-size="9">',i+=p+"</text>")}t.innerHTML=i,t.onclick=function(e){var n=t.getBoundingClientRect(),i=e.clientX-n.left,o=0|i/(n.width/r),s="0x"+a.entropy[o].addr.toString(16);seek(s)}})}function overviewLoad(t,e){if(!e.ready){var n=e[0],n=(e[1],e.cmd);e.grep&&(n+="~"+e.grep),r2.cmd(n,function(e){var n=document.getElementById(t.href.split("#")[1]);n.innerHTML="<pre style='margin:1.2em;'>"+clickableOffsets(e)+"<pre>"}),e.ready=!0}}function getConf(t){var e=localStorage.getItem(t.name);return null!==e?("false"===e?e=!1:"true"===e&&(e=!0),e):t.defVal}function saveConf(t,e){localStorage.setItem(t.name,e),t.apply(e)}function applyConf(t){t="undefined"!=typeof t&&t;for(var e in R2Conf){var n=R2Conf[e];(!t&&getConf(n)!==n.defVal||t)&&n.apply(getConf(n))}}function resetConf(){for(var t in R2Conf){var e=R2Conf[t];localStorage.removeItem(e.name)}applyConf(!0)}function panelSettings(){var t=widgetContainer.getWidget("Settings"),e=widgetContainer.getWidgetDOMWrapper(t);e.innerHTML="",updates.registerMethod(t.getOffset(),panelSettings);var n=document.createElement("div");n.className="mdl-grid",e.appendChild(n);var i=createGrid(n,"Platform");drawPlatform(i);var a=createGrid(n,"Disassembly");drawDisassembly(a);var o=createGrid(n,"Core/IO");drawCoreIO(o);var s=createGrid(n,"Analysis");drawAnalysis(s);var r=createGrid(n,"Colors");drawColors(r);var l=createGrid(n,"TTS");drawTTS(l);var c=createGrid(n,"Reset configuration");uiActionButton(c,function(){resetConf(),update()},"RESET"),componentHandler.upgradeDom()}function savedFromList(t,e,n){var i=n,a=localStorage.getItem(e);return null!==a&&(i=t.indexOf(a)),i}function drawPlatform(t){var e=["x86","arm","mips","java","dalvik","6502","8051","h8300","hppa","i4004","i8008","lh5801","lm32","m68k","malbolge","mcs96","msp430","nios2","ppc","rar","sh","snes","sparc","spc700","sysz","tms320","v810","v850","ws","xcore","prospeller","gb","z80","arc","avr","bf","cr16","cris","csr","dcpu16","ebc"];uiSelect(t,"Platform",e,e.indexOf(getConf(R2Conf.platform)),function(t){saveConf(R2Conf.platform,t)});var n=["64","32","16","8"];uiSelect(t,"Bits",n,n.indexOf(getConf(R2Conf.bits)),function(t){saveConf(R2Conf.bits,t)});var i=["Linux","Windows","OSX"];uiSelect(t,"OS",i,i.indexOf(getConf(R2Conf.os)),function(t){saveConf(R2Conf.os,t)})}function drawDisassembly(t){var e=["S","M","L"];uiSelect(t,"Size",e,e.indexOf(getConf(R2Conf.size)),function(t){saveConf(R2Conf.size,t)});var n=["Pseudo","Opcodes","ATT"];uiSelect(t,"Decoding",n,n.indexOf(getConf(R2Conf.decoding)),function(t){saveConf(R2Conf.decoding,t)}),uiSwitch(t,"Utf8",getConf(R2Conf.utf8),function(t,e){saveConf(R2Conf.utf8,e)}),uiSwitch(t,"UpperCase",getConf(R2Conf.ucase),function(t,e){saveConf(R2Conf.ucase,e)}),uiSwitch(t,"Show Bytes",getConf(R2Conf.bytes),function(t,e){saveConf(R2Conf.bytes,e)}),uiSwitch(t,"DescribeOps",getConf(R2Conf.describe),function(t,e){saveConf(R2Conf.describe,e)})}function drawCoreIO(t){var e=["PA","VA","Debug"];uiSelect(t,"Mode",e,e.indexOf(getConf(R2Conf.mode)),function(t){saveConf(R2Conf.mode,t)})}function drawAnalysis(t){var e=function(t,e,n){saveConf(n,e)};uiSwitch(t,"HasNext",getConf(R2Conf.analHasNext),function(t,n){return e(t,n,R2Conf.analHasNext)}),uiSwitch(t,"Skip Nops",getConf(R2Conf.analSkipNops),function(t,n){return e(t,n,R2Conf.analSkipNops)}),uiSwitch(t,"NonCode",getConf(R2Conf.analNonCode),function(t,n){return e(t,n,R2Conf.analNonCode)})}function drawColors(t){var e;r2.cmdj("ecoj",function(t){e=t}),uiSwitch(t,"Colors",getConf(R2Conf.colors),function(t,e){saveConf(R2Conf.colors,e)}),uiActionButton(t,function(){r2.cmd("ecr",function(){update()})},"Randomize"),uiActionButton(t,function(){r2.cmd("ecd",function(){update()})},"Reset colors"),uiSelect(t,"Theme",e,e.indexOf(getConf(R2Conf.theme)),function(t){saveConf(R2Conf.theme,t)})}function drawTTS(t){uiSwitch(t,"Use TTS",getConf(R2Conf.useTTS),function(t,e){saveConf(R2Conf.useTTS,e)})}function createGrid(t,e){var n=document.createElement("div");n.className="mdl-cell mdl-color--white mdl-shadow--2dp mdl-cell--4-col",n.style.padding="10px",t.appendChild(n);var i=document.createElement("span");i.className="mdl-layout-title",i.innerHTML=e,n.appendChild(i);var a=document.createElement("div");return n.appendChild(a),a}ActionListener.prototype.registerLocalAction=function(t,e){this.actions[t]=e},ActionListener.prototype.applyGlobal=function(t){this.cmd(t)},ActionListener.prototype.apply=function(t){if(this.applyGlobal(t),"undefined"!=typeof t)for(var e=widgetContainer.getCurrentlyDrawn(),n=0;n<e.length;n++){var i=this.actions[e[n]];"undefined"!=typeof i&&i(t)}},Autocompletion.prototype.Keys={UP:38,DOWN:40,ENTER:13},Autocompletion.prototype.Nodes={EMPTY:{pos:-1,offset:0,length:0,name:"No match!"}},Autocompletion.prototype.init_=function(){this.form_=document.getElementById(this.form_),this.dropdown_=document.getElementById(this.dropdown_);var t=this.keyHandler.bind(this);this.form_.addEventListener("keyup",t);var e=this;this.form_.addEventListener("focus",function(){e.prevLength_>=e.minChar_&&e.show()}),this.form_.addEventListener("blur",function(){e.hide()}),this.flags_=void 0,this.activeChoice_=0,this.prevLength_=0,this.list_,this.completions_,this.populate_()},Autocompletion.prototype.populate_=function(){var t=this;r2.cmdj(this.cmd_,function(e){t.flags_=e})},Autocompletion.prototype.process_=function(t){for(var e=[],n=0,i=0;i<this.flags_.length;i++){var a=this.flags_[i].name.indexOf(t,0);if(a!==-1&&e.push({pos:n++,offset:a,length:t.length,name:this.flags_[i].name}),n==this.maxProp_)return e}return e},Autocompletion.prototype.addNode_=function(t,e){var n=document.createElement("li");e&&(n.className="active");var i=this;n.addEventListener("mouseover",function(t){return function(){i.setActiveChoice(t)}}(t.pos)),n.addEventListener("click",function(t){return function(){i.setActiveChoice(t),i.valid()}}(t.pos));var a=document.createElement("strong");a.appendChild(document.createTextNode(t.name.substr(t.offset,t.length))),n.appendChild(document.createTextNode(t.name.substr(0,t.offset))),n.appendChild(a),n.appendChild(document.createTextNode(t.name.substr(t.offset+t.length,t.name.length-(t.offset+t.length)))),this.dropdown_.appendChild(n)},Autocompletion.prototype.cleanChoices_=function(){for(;this.dropdown_.firstChild;)this.dropdown_.removeChild(this.dropdown_.firstChild)},Autocompletion.prototype.setActiveChoice=function(t){for(i in this.dropdown_.childNodes)i==t?this.dropdown_.childNodes[i].className="active":i==this.activeChoice_&&(this.dropdown_.childNodes[i].className="");this.activeChoice_=t},Autocompletion.prototype.keyMovement_=function(t){t==this.Keys.UP&&this.activeChoice_>0&&(console.log("UP"),this.setActiveChoice(this.activeChoice_-1)),t==this.Keys.DOWN&&this.activeChoice_<this.dropdown_.childNodes.length-1&&(console.log("DOWN"),this.setActiveChoice(this.activeChoice_+1))},Autocompletion.prototype.valid=function(){if(!(this.activeChoice_==-1||this.dropdown_.childNodes.length<=this.activeChoice_))return this.form_.blur(),this.prepareView(),seek(this.completions_[this.activeChoice_].name)},Autocompletion.prototype.show=function(){this.dropdown_.style.display="block"},Autocompletion.prototype.hide=function(){this.dropdown_.style.display="none"},Autocompletion.prototype.keyHandler=function(t){if(t.keyCode==this.Keys.UP||t.keyCode==this.Keys.DOWN)return this.keyMovement_(t.keyCode);if(t.keyCode==this.Keys.ENTER)return this.hide(),this.valid();var e=t.target.value;if(this.cleanChoices_(),e.length>=2){if(this.show(),this.completions_=this.process_(e),this.prevLength_!==e.length&&(this.activeChoice_=0),0==this.completions_.length)this.addNode_(this.Nodes.EMPTY,!1);else for(var n in this.completions_)this.addNode_(this.completions_[n],n==this.activeChoice_);this.prevLength_=e.length}else this.hide()},Autocompletion.prototype.setPrepareView=function(t){this.preparationCallback=t},Autocompletion.prototype.prepareView=function(){"undefined"!=typeof this.preparationCallback&&this.preparationCallback()},BlockNavigator.prototype.Dir={BEFORE:-1,CURRENT:0,AFTER:1},BlockNavigator.prototype.Status={LAUNCHED:0,COMPLETED:1},BlockNavigator.prototype.init=function(){return"undefined"==typeof this.providerWorker?void console.log("provider worker should be defined"):void this.configureWorker_()},BlockNavigator.prototype.configureWorker_=function(){var t=this;this.providerWorker.onmessage=function(e){if(e.data.dir===t.Dir.CURRENT){if("undefined"!=typeof t.curChunk.data.callback)for(var n=0;n<t.curChunk.data.callback.length;n++)t.curChunk.data.callback[n](e.data);t.curChunk.data=e.data,t.curChunk.data.status=t.Status.COMPLETED}else{for(var i=e.data.dir===t.Dir.BEFORE?"prev":"next",a=t.curChunk;"undefined"!=typeof a[i]&&(a=a[i],a.data.offset!==e.data.offset););if(a===t.curChunk)return void console.log("Error, history corrupted");if("undefined"!=typeof a.data.callback)for(var n=0;n<a.data.callback.length;n++)a.data.callback[n](e.data);a.data=e.data,a.data.status=t.Status.COMPLETED}}},BlockNavigator.prototype.reset=function(){this.curChunk=void 0},BlockNavigator.prototype.go=function(t){var e=t===this.Dir.AFTER,n=e?"next":"prev";this.gap;if("undefined"!=typeof this.curChunk[n])this.curChunk=this.curChunk[n],this.currentOffset=this.curChunk.data.offset;else{this.currentOffset=this.currentOffset+t*this.gap;var i={dir:t,offset:this.currentOffset,status:this.Status.LAUNCHED,callback:[]};this.currentOffset<0&&(i.substract=this.currentOffset*-1,i.offset=0,this.currentOffset=0);var a={data:i,prev:e?this.curChunk:void 0,next:e?void 0:this.curChunk};this.curChunk[n]=a,this.curChunk=a,this.providerWorker.postMessage(i)}},BlockNavigator.prototype.get=function(t,e,n){var i,a=t===this.Dir.BEFORE?"prev":"next";return i=t===this.Dir.CURRENT?this.curChunk:"undefined"==typeof this.curChunk?void 0:this.curChunk[a],"undefined"==typeof i?t===this.Dir.CURRENT?(req={dir:this.Dir.CURRENT,offset:this.currentOffset,status:this.Status.LAUNCHED,callback:[]},this.curChunk={data:req,prev:void 0,next:void 0},i=this.curChunk,this.providerWorker.postMessage(req)):(req={dir:t,offset:this.currentOffset+t*this.gap,status:this.Status.LAUNCHED,callback:[]},this.curChunk[a]={data:req,prev:t===this.Dir.AFTER?this.curChunk:void 0,next:t===this.Dir.BEFORE?this.curChunk:void 0},i=this.curChunk[a],this.providerWorker.postMessage(req)):n===!0&&(i.data.status=this.Status.LAUNCHED,this.providerWorker.postMessage(i.data)),i.data.status!==this.Status.LAUNCHED?e(i.data):("undefined"==typeof i.data.callback&&(i.data.callback=[]),void i.data.callback.push(e))},BlockNavigator.prototype.isInside_=function(t,e){var n=t.offset,i=n+this.gap;return n<=e&&i>=e},ContainerZone.prototype.Layout={FULL:"full",HORIZONTAL:"horizontal",VERTICAL:"vertical"},ContainerZone.prototype.fallbackWidget=function(t){this.fallback=t},ContainerZone.prototype.initRuler=function(){var t={},e=this;this.rulerProp={gap:.005,pos:.5};var n=function(n){t={startX:n.clientX,startWidth:parseInt(document.defaultView.getComputedStyle(e.ruler).width,10),interval:n.clientX-e.ruler.offsetLeft},document.documentElement.addEventListener("mousemove",i,!1),document.documentElement.addEventListener("mouseup",a,!1),n.preventDefault()},i=function(n){var i=(n.clientX-t.interval)/e.container.offsetWidth;e.rulerProp.pos=i,e.container.children[0].style.width=100*(i-e.rulerProp.gap)+"%",e.container.children[1].style.width=100*(1-i-e.rulerProp.gap)+"%",e.ruler.style.marginLeft=100*i+"%"},a=function(){document.documentElement.removeEventListener("mousemove",i,!1),document.documentElement.removeEventListener("mouseup",a,!1)};this.ruler.addEventListener("mousedown",n)},ContainerZone.prototype.setFocus=function(t){this.focus_=t;for(var e=0;e<this.focusListeners.length;e++)this.focusListeners[e].focusHasChanged(t)},ContainerZone.prototype.getFocus=function(){return this.focus_},ContainerZone.prototype.getWidget=function(t,e){for(var e="undefined"==typeof e,n=0;n<this.widgets.length;n++)if(this.widgets[n].getName()===t)return e&&this.add(this.widgets[n]),this.widgets[n];var i=new Widget(t);return this.widgets.push(i),e&&this.add(i),i},ContainerZone.prototype.getWidgetDOMWrapper=function(t){var e=this.populatedWidgets.indexOf(t);return e===-1?void console.log("Can't get DOM wrapper of a non-populated widget"):this.container.children[e]},ContainerZone.prototype.isSplitted=function(){return this.currentLayout!==this.Layout.FULL},ContainerZone.prototype.merge=function(){if(this.isSplitted()){this.ruler.style.marginLeft="50%",this.ruler.style.display="none",this.rulerProp.pos=.5;var t=this.getWidgetDOMWrapper(this.populatedWidgets[this.getFocus()]);t.className="rwidget full focus",t.style.width="auto";for(var e=0;e<this.container.children.length;e++)e!=this.getFocus()&&(this.container.removeChild(this.container.children[e]),this.populatedWidgets.splice(e,1));this.setFocus(0),this.currentLayout=this.Layout.FULL,this.drawTitle()}},ContainerZone.prototype.split=function(t){if(!this.isSplitted()){this.ruler.style.display="block",this.container.children[0].style.width=100*(this.rulerProp.pos-this.rulerProp.gap)+"%";for(var e=0;e<this.populatedWidgets.length;e++)this.getWidgetDOMWrapper(this.populatedWidgets[e]).classList.remove("full"),this.getWidgetDOMWrapper(this.populatedWidgets[e]).classList.add(t);this.currentLayout=t,this.populatedWidgets.length<=1&&this.fallback(),this.setFocus(1),this.drawTitle()}},ContainerZone.prototype.getCurrentlyDrawn=function(){for(var t=[],e=0;e<this.populatedWidgets.length;e++)t.push(this.populatedWidgets[e].name);return t},ContainerZone.prototype.add=function(t){if(this.populatedWidgets.indexOf(t)===-1){if(t.isAlreadyThere())return this.populatedWidgets.push(t),void this.applyFocusEvent_(t);var e=document.createElement("div");if(e.classList.add("rwidget"),e.classList.add(this.currentLayout),t.binding(e),this.isSplitted()){var n=this.populatedWidgets.length>=2;n&&(this.container.removeChild(this.container.children[this.getFocus()]),this.populatedWidgets.splice(this.getFocus(),1)),0===this.getFocus()&&n?(this.populatedWidgets.unshift(t),t.isAlreadyThere()||(this.container.insertBefore(e,this.container.children[0]),this.container.children[0].style.width=100*(this.rulerProp.pos-this.rulerProp.gap)+"%")):(this.populatedWidgets.push(t),t.isAlreadyThere()||(this.container.appendChild(e),this.container.children[1].style.width=100*(1-this.rulerProp.pos-this.rulerProp.gap)+"%"))}else this.populatedWidgets.length>=1&&this.container.removeChild(this.container.children[this.getFocus()]),this.populatedWidgets=[t],t.isAlreadyThere()||(this.container.appendChild(e),this.container.children[0].style.width="auto");this.moveFocusOnWidget(t),this.applyFocusEvent_(t),t.setOffset(this.getFocus()),this.drawTitle()}},ContainerZone.prototype.moveFocusOnWidget=function(t){this.setFocus(this.populatedWidgets.indexOf(t)),this.container.children[this.getFocus()].classList.add("focus"),this.isSplitted()&&this.container.children[(this.getFocus()+1)%2].classList.remove("focus"),this.drawTitle()},ContainerZone.prototype.drawTitle=function(){if(this.layout===this.Layout.FULL||1===this.populatedWidgets.length)this.title.innerHTML=this.populatedWidgets[0].getName();else{for(var t=[],e=0;e<this.populatedWidgets.length;e++)this.getFocus()==e?t.push("<strong>"+this.populatedWidgets[e].getName()+"</strong>"):t.push(this.populatedWidgets[e].getName());this.title.innerHTML=t.join(" & ")}},ContainerZone.prototype.applyFocusEvent_=function(t){var e=this,n=this.getWidgetDOMWrapper(t);n.addEventListener("mousedown",function(){e.moveFocusOnWidget(t)})},ContainerZone.prototype.addFocusListener=function(t){this.focusListeners.push(t)},function(){function t(){a++,r2.cmdj("?V",function(t){"undefined"!=typeof t&&(a=0)})}function e(){if(a>0){for(var t=document.getElementsByClassName("first-attempt"),e=0;e<t.length;e++)t[e].style.display="none";for(var n=document.getElementsByClassName("next-attempt"),e=0;e<n.length;e++)n[e].style.display="block"}}var n=document.getElementById("networkerr"),i=!1,a=0;n.showModal||dialogPolyfill.registerDialog(n),n.querySelector(".retry").addEventListener("click",function(){n.close(),t(),i=!1}),n.querySelector(".close").addEventListener("click",function(){n.close(),i=!1}),n.querySelector(".ok").addEventListener("click",function(){n.close(),i=!1}),r2.err=function(){i||(e(),n.showModal())}}();var update=function(){},inColor=!0,lastView=panelDisasm,seekAction=new ActionListener(function(t){if(void 0===t)var e=prompt("address");else var e=t;e&&""!=e.trim()&&(r2.cmd("s "+e),lastView(),document.getElementById("content").scrollTop=0,update())}),seek=function(t){return seekAction.apply(t)},lastConsoleOutput="",foo="",nativeDebugger=!1;Array.prototype.forEach.call(document.querySelectorAll(".mdl-card__media"),function(t){var e=t.querySelector("a");if(e){var n=e.getAttribute("href");n&&t.addEventListener("click",function(){location.href=n})}});var twice=!1,widgetContainer=void 0,updates=void 0,lastViews=void 0;window.onload=ready,document.addEventListener("DOMContentLoaded",ready,!1),document.body.onkeypress=function(t){if(t.ctrlKey){const e=[panelConsole,panelDisasm,panelDebug,panelHexdump,panelFunctions,panelFlags,panelOverview,panelSettings,panelSearch];t.charCode=="o".charCodeAt(0)&&seek();var n=t.charCode-48;if(n>=0&&n<e.length){var i=e[n];i&&i()}}},RadareInfiniteBlock.prototype.Dir={BEFORE:-1,CURRENT:0,AFTER:1},RadareInfiniteBlock.prototype.getCurChunk=function(){return this.curChunk},RadareInfiniteBlock.prototype.getFirstElement=function(){return this.firstElement},RadareInfiniteBlock.prototype.refreshInitialOffset=function(){var t=this;r2.cmd("s",function(e){t.initialOffset=parseInt(e,16)})},RadareInfiniteBlock.prototype.defineInfiniteParams=function(t){var e=0===this.container.getBody().offsetHeight?800:this.container.getBody().offsetHeight;this.howManyLines=Math.floor(e/this.lineHeight*this.infineHeightProvisioning);var n=new InfiniteScrolling(this.container.getBody(),3,"undefined"!=typeof t?t:.2),i=this;n.setTopEvent(function(t,e){i.nav.go(i.nav.Dir.BEFORE),i.infiniteDrawingContent(i.Dir.BEFORE,t,e)}),n.setBottomEvent(function(t,e){i.nav.go(i.nav.Dir.AFTER),i.infiniteDrawingContent(i.Dir.AFTER,t,e)})};var statusLog=[],Mode={LINE:0,HALF:1,FULL:2},Tab={LOGS:0,CONSOLE:1},statusMode=Mode.LINE,statusTimeout=null,statusTab=Tab.LOGS;statusInitialize();var comboId=0,idSwitch=0,selectId=0;Table.prototype.init=function(){this.root=document.createElement("table"),this.root.className="mdl-data-table mdl-data-table--selectable mdl-shadow--2dp",this.root.id!==!1&&(this.root.id=this.id),this.thead=document.createElement("thead"),this.root.appendChild(this.thead),this.tbody=document.createElement("tbody"),this.root.appendChild(this.tbody);var t=document.createElement("tr");this.thead.appendChild(t);for(var e in this.cols){"+"==this.cols[e][0]?(this.clickableOffset[e]=!0,this.cols[e]=this.cols[e].substr(1)):"~"==this.cols[e][0]&&(this.contentEditable[e]=!0);var n=document.createElement("th");n.appendChild(document.createTextNode(this.cols[e])),this.nonum[e]&&(n.className="mdl-data-table__cell--non-numeric"),t.appendChild(n)}},Table.prototype.addRow=function(t){var e=document.createElement("tr");this.tbody.appendChild(e);for(var n=0;n<t.length;n++){var i=document.createElement("td");if(this.clickableOffset[n]?i.innerHTML=clickableOffsets(t[n]):i.innerHTML=t[n],this.contentEditable[n]){var a=this;i.initVal=i.innerHTML,i.contentEditable=!0,i.busy=!1,i.addEventListener("blur",function(e){e.target.busy||e.target.initVal!=e.target.innerHTML&&(e.target.busy=!0,a.onChange(t,e.target.innerHTML),e.target.initVal=e.target.innerHTML,e.target.busy=!1)}),i.addEventListener("keydown",function(e){13!=e.keyCode||e.target.busy||e.target.initVal!=e.target.innerHTML&&(e.preventDefault(),e.target.busy=!0,a.onChange(t,e.target.innerHTML),e.target.initVal=e.target.innerHTML,e.target.busy=!1,e.target.blur())})}e.appendChild(i)}},Table.prototype.insertInto=function(t){t.appendChild(this.root),this.id!==!1&&$("#"+this.id).DataTable()},UpdateManager.prototype.registerMethod=function(t,e){this.updateMethods[t]=e},UpdateManager.prototype.focusHasChanged=function(t){this.currentFocus=t},UpdateManager.prototype.apply=function(){"undefined"!=typeof this.currentFocus&&this.updateMethods[this.currentFocus]()},Widget.prototype.binding=function(t){this.DOMWrapper=t,"undefined"!=typeof this.content&&(this.DOMWrapper.innerHTML=this.content)},Widget.prototype.setHTMLContent=function(t){this.content=t},Widget.prototype.getName=function(){return this.name},Widget.prototype.getIdentifier=function(){return this.identifier},Widget.prototype.setOffset=function(t){this.offset=t},Widget.prototype.getOffset=function(){return this.offset},Widget.prototype.isAlreadyThere=function(){return"undefined"!=typeof this.identifier},Widget.prototype.setDark=function(){this.DOMWrapper.style.backgroundColor="rgb(32, 32, 32)","undefined"!=typeof this.DOMWrapper.children[1]&&(this.DOMWrapper.children[1].style.backgroundColor="rgb(32, 32, 32)")},Disasm.prototype=new RadareInfiniteBlock,Disasm.prototype.constructor=Disasm,Disasm.prototype.infineHeightProvisioning=3,Disasm.prototype.init=function(){var t=this;this.drawContextualMenu(),this.drawAnalysisDialog(),this.defineInfiniteParams(.05),this.container.pause("Crunching some data..."),this.nav.crunchingData(function(){t.container.resume()})},Disasm.prototype.resetContainer=function(t){this.container.replug(t),this.container.reset(),this.refreshInitialOffset(),this.defineInfiniteParams(.05)},Disasm.prototype.defineInfiniteParams=function(t){RadareInfiniteBlock.prototype.defineInfiniteParams.call(this,t),this.nav=new DisasmNavigator(this.howManyLines,this.initialOffset)},Disasm.prototype.draw=function(t){var e=this;this.drawControls(this.container.getControls()),this.container.drawBody(function(n){e.drawContent(n,function(){e.replaceScrollPosition(e.nav.currentOffset),"undefined"!=typeof t&&t()})})},Disasm.prototype.processChosenAnalysis=function(t){for(var e=0;e<this.analysisMethods.length;e++)this.analysisMethods[e].action(this.analysisMethods[e].active);var n=this;this.nav.crunchingData(function(){n.draw(t)})},Disasm.prototype.drawAnalysisDialog=function(){this.analysisMethods=[{name:"Analyse current offset",ugly:"curoffset",active:!0,action:function(t){t&&r2.cmd("af")}},{name:"Analyze symbols",ugly:"symbols",active:!1,action:function(t){t&&r2.cmd("aa")}},{name:"Analyse calls",ugly:"calls",active:!1,action:function(t){t?r2.cmd("e anal.calls=true;aac"):r2.cmd("e anal.calls=false")}},{name:"Emulate code",ugly:"code",active:!1,action:function(t){t?r2.cmd("e asm.emu=1;aae;e asm.emu=0"):r2.cmd("e asm.emu=false")}},{name:"Find preludes",ugly:"preludes",active:!1,action:function(t){t&&r2.cmd("aap")}},{name:"Autoname functions",ugly:"fcts",active:!1,action:function(t){t&&r2.cmd("aan")}}];var t=this;this.analysisDialog=document.createElement("dialog"),this.analysisDialog.className="mdl-dialog",this.analysisDialog.showModal||dialogPolyfill.registerDialog(this.analysisDialog);var e=document.createElement("div");e.className="mdl-dialog__content",this.analysisDialog.appendChild(e);var n=document.createElement("p");n.appendChild(document.createTextNode("Pick some analysis method")),n.className="mdl-typography--text-center",e.appendChild(n);var i=document.createElement("ul");i.className="mdl-card__supporting-text",this.analysisDialog.appendChild(i);for(var a=0;a<this.analysisMethods.length;a++){var o=document.createElement("li");i.appendChild(o);var s=document.createElement("label");s.for=this.analysisMethods[a].ugly,s.className="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect",o.appendChild(s);var r=document.createElement("input");r.type="checkbox",r.offset=a,r.id=this.analysisMethods[a].ugly,r.checked=this.analysisMethods[a].active,r.className="mdl-checkbox__input",s.appendChild(r),r.addEventListener("change",function(e){t.analysisMethods[e.target.offset].active=e.target.checked});var l=document.createElement("span");l.className="mdl-checkbox__label",l.appendChild(document.createTextNode(this.analysisMethods[a].name)),s.appendChild(l)}var c=document.createElement("div");c.className="mdl-dialog__actions",this.analysisDialog.appendChild(c);var d=document.createElement("button");d.className="mdl-button",d.innerHTML="Proceed",d.addEventListener("click",function(){t.processChosenAnalysis(function(){t.analysisDialog.close();
})}),c.appendChild(d);var u=document.createElement("button");u.className="mdl-button",u.innerHTML="Close",u.addEventListener("click",function(){t.analysisDialog.close()}),c.appendChild(u),document.body.appendChild(this.analysisDialog),componentHandler.upgradeDom()},Disasm.prototype.extractOffset_=function(t){return parseInt(t.slice(5))},Disasm.prototype.getCurrentOffset=function(){return this.currentOffset},Disasm.prototype.oncontextmenu=function(t,e){this.refreshContextMenu(e);var n=document.getElementById("contextmenuDisasm");t.preventDefault(),this.contextMenuOpen?n.classList.remove("active"):(this.currentOffset=e,n.classList.add("active"),n.style.left=t.clientX+"px",n.style.top=t.clientY+"px"),this.contextMenuOpen=!this.contextMenuOpen},Disasm.prototype.onfctmenu=function(t,e){t.preventDefault();var n;r2.cmd("?v "+e,function(t){n=t});var i=prompt("Rename?",e);null!==i&&""!==i&&r2.cmd("fr "+i+"@ "+n)},Disasm.prototype.onvarmenu=function(t,e){t.preventDefault();var n=prompt("Rename?",e);null!==n&&""!==n&&r2.cmd("afvn "+e+" "+n)},Disasm.prototype.refreshContextMenu=function(t){var e;r2.cmdj("aoj @"+t,function(t){e="undefined"==typeof t[0].val}),this.drawContextualMenu(!e)},Disasm.prototype.getPresentBlock=function(){for(var t=[],e=this.container.getBody(),n=0;n<e.length;n++)t.push(this.extractOffset_(e[n].className));return t},Disasm.prototype.drawContent=function(t,e){var n=this,i=this.nav.getShownOffset();if(isTopMax=0===i[0],!this.isTopMax||!isTopMax){this.isTopMax=isTopMax,this.container.getBody().innerHTML="";for(var a=0;a<i.length;a++){var o=document.createElement("span");this.container.getBody().appendChild(o),this.nav.get(i[a].offset,i[a].size,function(t,i){return function(a){n.drawChunk(a,t),i&&"undefined"!=typeof e&&e()}}(o,a===i.length-1))}}},Disasm.prototype.drawChunk=function(t,e){e.innerHTML=t.data;for(var n=e.children[0],i=n.children,a=this,o=0;o<i.length;o++)"SPAN"===i[o].tagName&&(i[o].className.indexOf("offset")!==-1?i[o].addEventListener("contextmenu",function(t){return function(e){return a.oncontextmenu(e,t)}}(i[o].id)):i[o].className.indexOf("fcn")!==-1?i[o].addEventListener("contextmenu",function(t){return function(e){return a.onfctmenu(e,t)}}(i[o].id)):i[o].className.indexOf("var")!==-1&&i[o].addEventListener("contextmenu",function(t){return function(e){return a.onvarmenu(e,t)}}(i[o].id)));var s=document.getElementById(this.nav.getSeekOffset());return null!==s&&s.classList.add("currentOffset"),document.getElementById(e)},Disasm.prototype.infiniteDrawingContent=function(t,e,n){var i=this,a=this.firstVisibleOffset();this.drawContent(this.container.getBody(),function(){i.replaceScrollPosition(a),n()})},Disasm.prototype.drawControls=function(t){var e="";e+=uiButton("javascript:info()","Info"),e+=uiButton("javascript:write()","Wrte"),e+=uiButton("javascript:graph()","Grph"),e+=uiButton("javascript:disasm.openAnalysisDialog()","Anlz"),e+='<ul id="disasm-history"></ul>',t.innerHTML=e,this.history=document.getElementById("disasm-history"),this.drawHistory(this.history)},Disasm.prototype.drawHistory=function(t){var e=(this.indexOffsetHistory>0,this.indexOffsetHistory<this.offsetHistory.length-1,this);t.innerHTML="";for(var n=0;n<this.offsetHistory.length;n++){var i=n===this.indexOffsetHistory,a=document.createElement("li");a.className=i?"active":"",a.i=n,a.x=this.offsetHistory[n],a.appendChild(document.createTextNode(this.offsetHistory[n])),a.addEventListener("click",function(t){var n=t.target.x;seekAction.applyGlobal(n.toString()),e.indexOffsetHistory=t.target.i,e.drawControls(e.container.getControls())}),t.appendChild(a)}var a=document.createElement("li");a.title="Seek();",a.appendChild(document.createTextNode("?")),a.addEventListener("click",function(){seek()}),t.appendChild(a)},Disasm.prototype.openAnalysisDialog=function(){this.analysisDialog.showModal()},Disasm.prototype.firstVisibleOffset=function(){var t=this.container.getBody().scrollTop;if(0!==t){for(var e=0,n=this.container.getBody().children,i=n[0],a=1;a<n.length;a++){var o=n[a].getBoundingClientRect().height;if(e+=o,e>t){e-=o;break}i=n[a]}var s=e-t,r=i.getBoundingClientRect().height-s,l=this.extractOffset_(i.children[0].id),c=l+Math.ceil(r/this.lineHeight);return c}},Disasm.prototype.replaceScrollPosition=function(t){if("undefined"!=typeof t){var e=this.nav.getChunkPositionFor(t);if(e===-1)return void console.log("Chunk position from offset not found");for(var n=this.container.getBody().children[e],i=0;"undefined"==typeof n.children[i].id;)i++;var a=this.extractOffset_(n.children[i].id),o=n.offsetTop,s=n.getBoundingClientRect().height,r=(t-a)/this.nav.getSize(a),l=Math.floor(r*s),c=o+l;this.container.getBody().scrollTop=c}},Disasm.prototype.drawContextualMenu=function(t){var e=this,n=function(t,n){var i,a=n+" @"+t;return r2.cmdj(a,function(t){i=t}),null===i||i.constructor!==Array?void alert("No available ouput!"):void e.addLongListDialog(i)},i=function(t,n,i){var a="";"undefined"!=typeof i&&(a=prompt(i+"?"),""==a)||(""!=a&&(n+=" "+a),r2.cmd(n+" @"+t),e.nav.cleanOldData(),e.draw())},a=[{aoj:!1,name:"analyze function",shortcut:"F",fct:function(t,e){return i(e,"af")}},{aoj:!0,name:"immediate base...",shortcut:"i",expand:[{name:"binary",fct:function(t,e){return i(e,"ahi b")}},{name:"octal",fct:function(t,e){return i(e,"ahi o")}},{name:"decimal",fct:function(t,e){return i(e,"ahi d")}},{name:"hexadecimal",fct:function(t,e){return i(e,"ahi h")}},{name:"string",fct:function(t,e){return i(e,"ahi s")}}]},{aoj:!1,name:"add comment",shortcut:";",fct:function(t,e){return i(e,"CC","Name")}},{aoj:!1,name:"set flag",shortcut:"f",fct:function(t,e){return i(e,"f","Name")}},{aoj:!0,name:"rename flag",shortcut:"n",fct:function(t,e){return i(e,"fr","Name")}},{aoj:!0,name:"set string",shortcut:"s",fct:function(t,e){return i(e,"Cs")}},{aoj:!1,name:"find xrefs",shortcut:"x",fct:function(t,e){return n(e,"axtj")}},{aoj:!1,name:"as data",shortcut:"D",fct:function(t,e){return i(e,"Cd ","Size")}},{aoj:!1,name:"as code",shortcut:"F",fct:function(t,e){return i(e,"C-")}},{aoj:!1,name:"as string",shortcut:"S",fct:function(t,e){return i(e,"Cs")}}],o=document.getElementById("contextmenuDisasm");if(null===o){var o=document.createElement("nav");o.id="contextmenuDisasm",o.classList.add("context-menu")}else o.innerHTML="";var s=document.createElement("ul");o.appendChild(s);for(var e=this,r=function(t,n){t.addEventListener("mousedown",function(t){return function(n){t(n,e.getCurrentOffset())}}(n))},l=0;l<a.length;l++){var c=document.createElement("li");if(s.appendChild(c),c.appendChild(document.createTextNode(a[l].name)),c.isSubOpen=!1,c.addEventListener("mouseenter",function(t){for(var e=Array.prototype.slice.call(t.target.parentNode.getElementsByClassName("subactive")),n=0;n<e.length;n++)e[n].classList.remove("subactive"),e[n].isSubOpen=!1}),"undefined"!=typeof a[l].expand&&(t&&a[l].aoj||!a[l].aoj)){c.addEventListener("mouseenter",function(t){if(!t.target.isSubOpen){t.target.isSubOpen=!0;var e=t.target.children[0];if("undefined"!=typeof e){var n=t.target.getBoundingClientRect(),i=Array.prototype.slice.call(t.target.parentNode.children).indexOf(t.target);t.target.classList.add("subactive"),e.style.left=n.width+"px",e.style.top=i*n.height+"px"}}});var d=document.createElement("ul");c.appendChild(d);for(var u=0;u<a[l].expand.length;u++){var p=document.createElement("li");d.appendChild(p),p.appendChild(document.createTextNode(a[l].expand[u].name)),r(p,a[l].expand[u].fct)}}else t&&a[l].aoj||!a[l].aoj?r(c,a[l].fct):c.classList.add("disabled")}document.body.appendChild(o),componentHandler.upgradeDom();var e=this;this.contextMenuOpen=!1;var f=function(){e.contextMenuOpen&&(o.classList.remove("active"),e.contextMenuOpen=!1)};window.onkeyup=function(t){27===t.keyCode&&f()},document.addEventListener("click",function(){f()})},Disasm.prototype.addLongListDialog=function(t){var e=document.createElement("dialog");e.className="mdl-dialog",e.showModal||dialogPolyfill.registerDialog(e);var n=document.createElement("div");n.className="mdl-dialog__content",e.appendChild(n);var i=document.createElement("p");i.appendChild(document.createTextNode("Results")),i.className="mdl-typography--text-center",n.appendChild(i);var a=document.createElement("div");a.className="mdl-card__supporting-text",e.appendChild(a);var o=document.createElement("table");o.className="disasm-table-dialog",o.style.width="100%",o.style.border="1px dashed red",a.appendChild(o);var s=document.createElement("thead");o.appendChild(s);for(var r=Object.keys(t[0]),l=0;l<r.length;l++){var c=document.createElement("th");c.appendChild(document.createTextNode(r[l])),s.appendChild(c)}var d=document.createElement("tbody");o.appendChild(d);for(var l=0;l<t.length;l++){var u=document.createElement("tr");d.appendChild(u);for(var p=0;p<r.length;p++){var f=document.createElement("td");u.appendChild(f);var m;if("opcode"===r[p])m=clickableOffsets(t[l][r[p]]);else if("from"===r[p]){var h="0x"+t[l][r[p]].toString(16);m="<a href=\"javascript:seek('"+h+"');\">0x"+h+"</a>"}else m=t[l][r[p]];f.innerHTML=m}}var g=document.createElement("div");g.className="mdl-dialog__actions",e.appendChild(g);var v=document.createElement("button");v.className="mdl-button",v.innerHTML="Close",v.addEventListener("click",function(){e.close(),document.body.removeChild(e)}),g.appendChild(v),document.body.appendChild(e),componentHandler.upgradeDom(),e.showModal()},DisasmNavigator.prototype=new BlockNavigator,DisasmNavigator.prototype.constructor=DisasmNavigator,DisasmNavigator.prototype.init=function(){BlockNavigator.prototype.init.apply(this),this.currentlyShown=[],this.populateFirst()},DisasmNavigator.prototype.line2offset=function(t){return 2*t},DisasmNavigator.prototype.offset2line=function(t){return t/2},DisasmNavigator.prototype.configureWorker_=function(){var t=this;this.providerWorker.onmessage=function(e){for(var n,i=0;i<t.items.length;i++)t.items[i].offset===e.data.offset&&t.items[i].size===e.data.size&&(n=t.items[i]);if("undefined"==typeof n)return void console.log("Unable to find origin item");n.data=e.data.data,n.status=t.Status.COMPLETED;for(var i=0;i<n.callback.length;i++)n.callback[i](n);n.callback=[]}},DisasmNavigator.prototype.cleanOldData=function(){for(var t=0;t<this.items.length;t++)delete this.items[t].data,delete this.items[t].status},DisasmNavigator.prototype.crunchingData=function(t){var e=new Worker("disasmNavProvider.js"),n=this;e.onmessage=function(i){n.navigationData=i.data,n.navigationOffsets=Object.keys(i.data),n.navigationOffsets.sort(),e.terminate(),t()},e.postMessage(!0)},DisasmNavigator.prototype.getOverlappingIntervals=function(t,e){var n=[];for(var i in this.navigationData){var a=i,o=i+this.navigationData[i].size;(a<=t&&o>=e||a<=t&&o>=t||a<=e&&o>=e||a>=t&&o<=e)&&n.push(i)}return n},DisasmNavigator.prototype.populateFirst=function(){return this.populateFrom(this.currentOffset)},DisasmNavigator.prototype.fillGap=function(t,e,n){var i=e-t;return[{offset:t,size:i,artifical:n}]},DisasmNavigator.prototype.populateFrom=function(t){for(var e=t-this.line2offset(this.howManyLines),n=e+3*this.line2offset(this.howManyLines),i=this.getOverlappingIntervals(e,n),a=[],o=0;o<i.length-1;o++){var s=i[o],r=i[o+1];if(r<s)if(l<=s)a.push({offset:i[o],size:this.navigationData[i[o]].size});else{var l=r+this.navigationData[r].size;a.push({offset:i[o],size:l-i[o]})}}if(a.length>0){a[0].offset!==e&&(a=a.concat(this.fillGap(e,a[0].offset)));var c=a[a.length-1],d=c.offset+c.size;d!==n&&(a=a.concat(this.fillGap(d+1,n)));for(var o=0;o<a.length-1;o++){var s=i[o],r=i[o+1];r-s>1&&(a=a.concat(this.fillGap(s+1,r)))}}else a=this.fillGap(e,n,!0);this.currentlyShown=a},DisasmNavigator.prototype.getShownOffset=function(){return this.currentlyShown},DisasmNavigator.prototype.getSize=function(t){for(var e=0;e<this.currentlyShown.length;e++)if(this.currentlyShown[e].offset===t)return this.currentlyShown[e].size;return-1},DisasmNavigator.prototype.getChunkPositionFor=function(t){for(var e=0;e<this.currentlyShown.length;e++)if(t>=this.currentlyShown[e].offset&&t<this.currentlyShown[e].offset+this.currentlyShown[e].size)return e;return-1},DisasmNavigator.prototype.get=function(t,e,n){for(var i,a=0;a<this.items.length;a++)this.items[a].offset===t&&this.items[a].size===e&&(i=this.items[a]);return"undefined"==typeof i&&(i={offset:t,size:e},this.items.push(i)),"undefined"!=typeof i.data?n(i):("undefined"==typeof i.callback&&(i.callback=[]),i.callback.push(n),i.status!==this.Status.LAUNCHED&&(i.status=this.Status.LAUNCHED,this.providerWorker.postMessage({offset:i.offset,size:i.size})),void 0)},DisasmNavigator.prototype.go=function(t){this.currentOffset+=t*(2*this.howManyLines),this.populateFrom(this.currentOffset)},DisasmNavigator.prototype.refreshCurrentOffset=function(){var t=this;r2.cmd("s",function(e){t.currentOffset=parseInt(e,16)})},DisasmNavigator.prototype.getSeekOffset=function(){return this.currentOffset},Hexdump.prototype=new RadareInfiniteBlock,Hexdump.prototype.constructor=Hexdump,Hexdump.prototype.infineHeightProvisioning=2,Hexdump.prototype.Sizes={PAIRS:-1,HALF:2,WORD:4,QUADWORD:8},Hexdump.prototype.setOnChangeCallback=function(t){this.onChangeCallback=t},Hexdump.prototype.init=function(){var t=this;this.refreshInitialOffset(),r2.cmdj("ecj",function(e){t.colors=e}),r2.cmdj("ij",function(e){t.writable=e.core.iorw});for(var e in this.colors)this.colors[e]="rgb("+this.colors[e][0]+","+this.colors[e][1]+","+this.colors[e][2]+")";this.selectionMode=!this.writable,window.addEventListener("mousedown",function(e){0===e.button&&t.cleanSelection()}),this.drawContextualMenu(),this.changeWritable()},Hexdump.prototype.isWritable=function(){return this.writable&&!this.selectionMode},Hexdump.prototype.changeWritable=function(){for(var t=Array.prototype.slice.call(document.getElementsByClassName("writableMenu")),e=this.writable?1:.5,n=0;n<t.length;n++)t[n].style.opacity=e},Hexdump.prototype.resetContainer=function(t){this.refreshInitialOffset(),"undefined"!=typeof this.nav&&this.nav.reset(),this.container.replug(t),this.container.reset(),this.container.drawBody(function(t){t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div"))}),this.content=this.container.getBody(),this.defineInfiniteParams()},Hexdump.prototype.getCurrentSelection=function(){return this.currentSelection},Hexdump.prototype.defineInfiniteParams=function(){RadareInfiniteBlock.prototype.defineInfiniteParams.call(this),this.nav=new HexPairNavigator(this.howManyLines,this.nbColumns,this.initialOffset),this.nav.updateModifications()},Hexdump.prototype.draw=function(){var t=this;this.drawControls(this.container.getControls()),this.drawContent(this.container.getBody(),function(){t.colorizeFlag()})},Hexdump.prototype.colorizeByte=function(t,e){"00"===e||"ff"===e||"7f"==e?t.style.color=this.colors["b0x"+e]:isAsciiVisible(parseInt(e,16))?t.style.color="rgb(192,192,192)":t.style.color="inherit"},Hexdump.prototype.pickColor=function(){return this.lastColorUsed=(this.lastColorUsed+1)%this.bgColors.length,this.bgColors[this.lastColorUsed]},Hexdump.prototype.pairs2words=function(t,e){if(1===e)return t;var n;n=this.bigEndian?function(t,e){return t+e}:function(t,e){return e+t};for(var i=[],a=0;a<t.length/2;a++)i.push(n(t[2*a],t[2*a+1]));return this.pairs2words(i,e/2)},Hexdump.prototype.cleanSelection=function(t){"undefined"==typeof t&&(t=!1),t||(this.currentSelection={});var e;do{e=this.listContent.getElementsByClassName("selected");for(var n=0;n<e.length;n++)e[n].classList.remove("selected")}while(e.length>0)},Hexdump.prototype.processSelection=function(t){t&&this.cleanSelection(!0),this.selectionFirst===this.selectionEnd&&(this.selectionFirst.classList.add("selected"),this.currentSelection={from:this.selectionFirst.offset,to:this.selectionFirst.offset});var e=this.selectionFirst.offset<this.selectionEnd.offset?this.selectionFirst:this.selectionEnd,n=this.selectionFirst.offset<this.selectionEnd.offset?this.selectionEnd:this.selectionFirst;this.currentSelection={from:e.offset,to:n.offset};for(var i=e,a=!1;!a;){var o=i;for(i.classList.add("selected");null!==o;){if(o.offset===n.offset)return o.classList.add("selected"),i=o,void(a=!0);do i=o,o=o.nextSibling;while("undefined"==typeof i.offset);i.classList.add("selected")}var s=i.parentNode.parentNode.nextSibling;if(null===s)return;for(;s.children.length<=1;){if(null===s)return;s=s.nextSibling}i=s.children[1].children[0]}},Hexdump.prototype.drawContextualMenu=function(){var t=this,e=function(e,n,i,a){var o;r2.cmd(i+" "+(n.to-n.from)+" @"+n.from,function(t){o=t});var s=t.createExportDialog("Export as "+e+":",o,function(){var t,e=new Blob([o],{type:"text/plain"});r2.cmdj("ij",function(e){t=basename(e.core.file)}),t+="_0x"+n.from.toString(16)+"-0x"+n.to.toString(16)+"."+a,saveAs(e,t)});document.body.appendChild(s),componentHandler.upgradeDom(),s.showModal()},n=[{name:"Assembly",fct:function(t,n){return e("ASM",n,"pca","asm")}},{name:"Disassembly",fct:function(t,n){return e("DISASM",n,"pD","disasm")}},{name:"Hexpairs",fct:function(t,n){return e("HEXPAIRS",n,"p8","disasm")}},{name:"Base64 Encode",fct:function(t,n){return e("b64e",n,"p6e","disasm")}},{name:"Base64 Decode",fct:function(t,n){return e("b64d",n,"p6d","disasm")}},{name:"Binary",fct:function(e,n){var i,a=new Uint8Array(t.nav.getBytes(n)),o=new Blob([a],{type:"application/octet-stream"});r2.cmdj("ij",function(t){i=basename(t.core.file)}),i+="_0x"+n.from.toString(16)+"-0x"+n.to.toString(16)+".bin",saveAs(o,i)}},{name:"C",fct:function(t,n){return e("C",n,"pc","c")}},{name:"C half-words (2 bytes)",fct:function(t,n){return e("C",n,"pch","c")}},{name:"C words (4 bytes)",fct:function(t,n){return e("C",n,"pcw","c")}},{name:"C dwords (8 bytes)",fct:function(t,n){return e("C",n,"pcd","c")}},{name:"JavaScript",fct:function(t,n){return e("JS",n,"pcJ","js")}},{name:"JSON",fct:function(t,n){return e("JSON",n,"pcj","json")}},{name:"Python",fct:function(t,n){return e("Python",n,"pcp","py")}},{name:"R2 commands",fct:function(t,n){return e("R2 cmd",n,"pc*","r2")}},{name:"Shell script",fct:function(t,n){return e("Shell script",n,"pcS","txt")}},{name:"String",fct:function(t,n){return e("string",n,"pcs","txt")}}],i=function(e,n){var i=prompt("Value (valid hexpair):"),a=n+" "+i+" "+(e.to-e.from)+" @"+e.from;r2.cmd(a,function(){console.log("Call: "+a)}),t.nav.updateModifications(),t.nav.refreshCurrent(function(){t.draw()})},a=[{name:"addition",fct:function(t,e){return i(e,"woa")}},{name:"and",fct:function(t,e){return i(e,"woA")}},{name:"divide",fct:function(t,e){return i(e,"wod")}},{name:"shift left",fct:function(t,e){return i(e,"wol")}},{name:"multiply",fct:function(t,e){return i(e,"wom")}},{name:"or",fct:function(t,e){return i(e,"woo")}},{name:"shift right",fct:function(t,e){return i(e,"wor")}},{name:"substraction",fct:function(t,e){return i(e,"wos")}},{name:"write looped",fct:function(t,e){return i(e,"wow")}},{name:"xor",fct:function(t,e){return i(e,"wox")}},{name:"2 byte endian swap",fct:function(t,e){return i(e,"wo2")}},{name:"4 byte endian swap",fct:function(t,e){return i(e,"wo4")}}],o=[{name:"Set flag",fct:function(e,n){var i=prompt("Flag's name:");r2.cmd("f "+i+" "+(n.to-n.from+1)+" @"+n.from,function(){t.nav.refreshCurrent(function(){t.draw()})})}},{name:"Export as...",expand:n,requireWritable:!1},{name:"Operations...",expand:a,requireWritable:!0}],s=document.createElement("nav");s.id="contextmenuHex",s.classList.add("context-menu");var r=document.createElement("ul");s.appendChild(r);for(var t=this,l=function(e,n){e.addEventListener("mousedown",function(e){return function(n){e(n,t.getCurrentSelection())}}(n))},c=0;c<o.length;c++){var d=document.createElement("li");if(r.appendChild(d),d.appendChild(document.createTextNode(o[c].name)),d.isSubOpen=!1,d.requireWritable=o[c].requireWritable,o[c].requireWritable&&d.classList.add("writableMenu"),d.addEventListener("mouseenter",function(t){for(var e=Array.prototype.slice.call(t.target.parentNode.getElementsByClassName("subactive")),n=0;n<e.length;n++)e[n].classList.remove("subactive"),e[n].isSubOpen=!1}),"undefined"!=typeof o[c].expand){d.addEventListener("mouseenter",function(e){if((!e.target.requireWritable||t.writable)&&!e.target.isSubOpen){e.target.isSubOpen=!0;var n=e.target.children[0];if("undefined"!=typeof n){var i=e.target.getBoundingClientRect(),a=Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target);e.target.classList.add("subactive"),n.style.left=i.width+"px",n.style.top=a*i.height+"px"}}});var u=document.createElement("ul");d.appendChild(u);for(var p=0;p<o[c].expand.length;p++){var f=document.createElement("li");u.appendChild(f),f.appendChild(document.createTextNode(o[c].expand[p].name)),l(f,o[c].expand[p].fct)}}else l(d,o[c].fct)}document.body.appendChild(s),componentHandler.upgradeDom();var t=this;this.contextMenuOpen=!1;var m=function(){t.contextMenuOpen&&(s.classList.remove("active"),t.contextMenuOpen=!1)};window.onkeyup=function(t){27===t.keyCode&&m()},document.addEventListener("click",function(){m()})},Hexdump.prototype.createExportDialog=function(t,e,n){var i=document.createElement("dialog");i.className="mdl-dialog",i.showModal||dialogPolyfill.registerDialog(i);var a=document.createElement("div");a.className="mdl-dialog__content",i.appendChild(a);var o=document.createTextNode(t);a.appendChild(o);var s=document.createElement("textarea");s.style.width="100%",s.style.height="220px",a.appendChild(s),s.value=e;var r=document.createElement("div");r.className="mdl-dialog__actions",i.appendChild(r);var l=document.createElement("button");l.className="mdl-button",l.innerHTML="Save",l.addEventListener("click",function(){i.close(),i.parentNode.removeChild(i),n()}),r.appendChild(l);var c=document.createElement("button");return c.className="mdl-button",c.innerHTML="Close",c.addEventListener("click",function(){i.close(),i.parentNode.removeChild(i)}),r.appendChild(c),i},Hexdump.prototype.drawControls=function(t){t.innerHTML="";var e=this,n=document.createElement("ul");n.classList.add("controlList"),t.appendChild(n);var i=document.createElement("li");n.appendChild(i);var a=document.createElement("li");n.appendChild(a);var o=document.createElement("li");n.appendChild(o);var s=document.createElement("li");n.appendChild(s);var r=document.createElement("li");n.appendChild(r);var l=document.createElement("span"),c=document.createElement("select");l.appendChild(c);for(var d in this.Sizes){var u=document.createElement("option");u.value=this.Sizes[d],u.text=this.Sizes[d]>0?8*this.Sizes[d]+" bits":"pairs",this.Sizes[d]===this.hexLength&&(u.selected=!0),c.appendChild(u)}c.addEventListener("change",function(){e.hexLength=parseInt(this.value),e.draw()},!1);var p=document.createElement("input");p.className="mdl-textfield__input",p.style.width="26px",p.style.display="inline",p.pattern="[0-9]+",p.value=this.nbColumns;var f=function(t){return function(n){e.nbColumns=n,e.nav.changeNbCols(n),e.draw(),t.value=n}}(p),m=document.createElement("span");m.title="Number of columns per line";var h=document.createElement("button");h.className="mdl-button mdl-js-button mdl-button--icon",h.appendChild(document.createTextNode("-")),h.addEventListener("click",function(){f(e.nbColumns-1)});var g=document.createElement("button");g.className="mdl-button mdl-js-button mdl-button--icon",g.appendChild(document.createTextNode("+")),g.addEventListener("click",function(){f(e.nbColumns+1)}),p.addEventListener("change",function(t){var e=parseInt(t.target.value);f(e)}),m.appendChild(h),m.appendChild(document.createTextNode(" ")),m.appendChild(p),m.appendChild(document.createTextNode(" ")),m.appendChild(g);var v=document.createElement("input");v.classList.add("mdl-checkbox__input"),v.type="checkbox",v.checked=this.bigEndian;var y=document.createElement("span");y.classList.add("mdl-checkbox__label"),y.appendChild(document.createTextNode("bigEndian"));var b=document.createElement("label");b.classList.add("mdl-checkbox"),b.classList.add("mdl-js-checkbox"),b.classList.add("mdl-js-ripple-effect"),b.appendChild(v),b.appendChild(y),v.addEventListener("change",function(){e.bigEndian=!e.bigEndian,e.draw()});var C=document.createElement("input");C.classList.add("mdl-checkbox__input"),C.type="checkbox",C.checked=this.isWritable();var x=document.createElement("span");x.classList.add("mdl-checkbox__label"),x.appendChild(document.createTextNode("isEditable"));var w=document.createElement("label");w.classList.add("mdl-checkbox"),w.classList.add("mdl-js-checkbox"),w.classList.add("mdl-js-ripple-effect"),w.appendChild(C),w.appendChild(x),this.writable||(C.disabled=!0),C.addEventListener("change",function(){e.selectionMode=!e.selectionMode,e.draw()});var L=document.createElement("input");L.classList.add("mdl-checkbox__input"),L.type="checkbox",L.checked=this.showFlags;var E=document.createElement("span");E.classList.add("mdl-checkbox__label"),E.appendChild(document.createTextNode("showFlags"));var k=document.createElement("label");k.classList.add("mdl-checkbox"),k.classList.add("mdl-js-checkbox"),k.classList.add("mdl-js-ripple-effect"),k.appendChild(L),k.appendChild(E),L.addEventListener("change",function(){e.showFlags=!e.showFlags,e.draw()}),i.appendChild(l),a.appendChild(m),o.appendChild(b),s.appendChild(w),r.appendChild(k),componentHandler.upgradeDom()},Hexdump.prototype.getFlagColor=function(t){for(var e=0;e<this.flagColorAssociation.length;e++)if(this.flagColorAssociation[e].name===t)return this.flagColorAssociation[e].color;var n=this.pickColor();return this.flagColorAssociation.push({name:t,color:n}),n},Hexdump.prototype.applyFlags=function(t,e,n){if(this.showFlags)for(var i in n){var a,o=n[i];for(j=0;j<t.length;j++)if(t[j].offset.start<=o.offset&&t[j].offset.end>=o.offset){a=t[j];break}if("undefined"!=typeof a){var s=document.createElement("li"),r=int2fixedHex(o.offset,8);s.classList.add("block"+e),s.classList.add("flag"),s.offset=r,s.appendChild(document.createTextNode("["+r+"] "+o.name)),s.title="Go to Disassembly",s.style.cursor="pointer",s.addEventListener("click",function(t){return function(){return seekAction.applyGlobal(t),panelDisasm()}}(r)),s.title=o.size+" bytes",s.style.color=this.getFlagColor(o.name),this.listContent.insertBefore(s,a)}}},Hexdump.prototype.indexOfLine_=function(t){for(var e=[].slice.call(this.listContent.children),n=0;n<e.length;n++)if("undefined"!=typeof e[n].offset&&e[n].offset.start<=t&&e[n].offset.end>=t)return n;return-1},Hexdump.prototype.colorizeFlag=function(t){if(this.showFlags){"undefined"==typeof t&&(t=!1);var e=[].slice.call(this.listContent.children);if(t)for(var n=0;n<e.length;n++)e[n].backgroundColor="none";var i=this;this.nav.getFlags(2,function(t){for(var n=0;n<t.length;n++){var a=!1,o=i.indexOfLine_(t[n].start);if(o===-1)return void console.log("Undefined flag offset");for(var s=t[n].start-e[o].offset.start,r=o;r<e.length&&!a;r++)if("undefined"!=typeof e[r].offset){for(var l=e[r].children[1].children,c=s;c<l.length;c++){if(l[c].offset===t[n].end){a=!0;break}l[c].style.backgroundColor=i.getFlagColor(t[n].name)}s=0}}})}},Hexdump.prototype.drawContent=function(t,e){t.innerHTML="",this.listContent=document.createElement("ul"),this.listContent.className="listContent",t.appendChild(this.listContent);var n=this;this.listContent.addEventListener("contextmenu",function(t){"undefined"!=typeof n.currentSelection&&"undefined"!=typeof n.currentSelection.from&&"undefined"!=typeof n.currentSelection.to||(n.currentSelection={from:t.target.offset,to:t.target.offset}),t.preventDefault();var e=document.getElementById("contextmenuHex");n.contextMenuOpen?e.classList.remove("active"):(e.classList.add("active"),e.style.left=t.clientX+"px",e.style.top=t.clientY+"px"),n.contextMenuOpen=!n.contextMenuOpen}),this.nav.get(this.Dir.CURRENT,function(t){n.curChunk=t}),this.nav.get(this.Dir.BEFORE,function(t){n.isTopMax=0===t.offset,n.drawChunk(t),n.firstElement=n.drawChunk(n.getCurChunk())}),this.nav.get(this.Dir.AFTER,function(t){n.drawChunk(t),n.content.scrollTop=0,n.content.scrollTop=n.getFirstElement().getBoundingClientRect().top,"undefined"!=typeof e&&e()})},Hexdump.prototype.drawChunk=function(t,e){if(0===t.offset&&0===t.hex.length)return this.firstElement;var n,i,a=this;this.hexLength===-1?n=this.drawPairs_:(n=this.drawWords_,i=this.hexLength),"undefined"==typeof e&&(e=this.Dir.AFTER);for(var o,s,r=[],l=0;l<t.hex.length;l++){var c=document.createElement("li");c.className="block"+t.offset,e===this.Dir.AFTER?(this.listContent.appendChild(c),r.push(c),s=l):(this.listContent.insertBefore(c,this.listContent.firstChild),r.unshift(c),s=t.hex.length-1-l),c.offset={},c.offset.start=t.offset+this.nbColumns*s,c.offset.end=c.offset.start+(this.nbColumns-1);var d=document.createElement("ul"),u=document.createElement("ul"),p=document.createElement("ul");d.classList.add("offset");var f=document.createElement("li");d.appendChild(f),f.appendChild(document.createTextNode(int2fixedHex(t.offset+s*this.nbColumns,8))),f.assoc=u,f.addEventListener("dblclick",function(t){t.preventDefault(),a.selectionFirst=t.target.parentNode.nextSibling.children[0],a.selectionEnd=t.target.parentNode.nextSibling.children[a.nbColumns-1],a.processSelection()}),u.style.lineHeight=this.lineHeight+"px",u.classList.add("hexpairs"),p.classList.add("ascii"),c.appendChild(d),c.appendChild(u),c.appendChild(p),n.apply(this,[u,p,t.hex[s],t.ascii[s],t.modified,t.offset+this.nbColumns*s,i]),"undefined"==typeof o&&(o=c)}return this.applyFlags(r,t.offset,t.flags),o},Hexdump.prototype.infiniteDrawingContent=function(t,e,n){var i=this;this.nav.get(t,function(a){if(t===i.Dir.BEFORE?i.isTopMax=0===a.offset:i.isTopMax&&i.nav.get(i.Dir.BEFORE,function(t){t.offset>0&&(i.isTopMax=!1)}),0!==a.offset||0!==a.hex.length){var o;o=t===i.Dir.BEFORE?i.listContent.lastChild.className:i.listContent.firstChild.className;for(var s=Array.prototype.slice.call(document.getElementsByClassName(o)),r=0;r<s.length;r++)s[r].parentNode.removeChild(s[r]);i.drawChunk(a,t),i.content.scrollTop=e,i.colorizeFlag(!0),n(i.isTopMax)}})},Hexdump.prototype.showPairs_=function(t,e,n){n?(t.classList.add("active"),e.classList.add("active")):(t.classList.remove("active"),e.classList.remove("active"))},Hexdump.prototype.drawWords_=function(t,e,n,i,a,o,s){var r=this.pairs2words(n,s);t.classList.add("words");for(var l=0;l<n.length;l++){var c=document.createElement("li");c.appendChild(document.createTextNode(i[l])),e.appendChild(c),this.colorizeByte(c,n[l])}for(var l=0;l<r.length;l++){var d=document.createElement("li");if(2===s){var u=""+new Int16Array([+r[l]])[0];u.length<5&&(u=Array(5-u.length).join("_")+u)}else var u="0x"+r[l];d.appendChild(document.createTextNode(u)),t.appendChild(d)}},Hexdump.prototype.drawPairs_=function(t,e,n,i,a,o){t.classList.add("pairs");for(var s=this,r={keydown:function(t){13===t.keyCode&&c(t.target)},blur:function(t){c(t.target)}},l={keydown:function(t){13===t.keyCode&&d(t.target)},blur:function(t){d(t.target)}},c=function(t){if(!t.busy){t.busy=!0;var e=t.value.match(/$([a-fA-F0-9]{2})^/);if(null===e){if("undefined"==typeof t.parentNode)return;return alert("Wrong format, expected: [a-fA-F0-9]{2}"),void(t.parentNode.innerHTML=t.initValue)}var n=e[0];t=t.parentNode;var i=s.nav.reportChange(t.offset,n);t.innerHTML=n,t.assoc.innerHTML=hexPairToASCII(n),null!==i&&(t.classList.add("modified"),t.assoc.classList.add("modified"),s.colorizeByte(t,n),s.colorizeByte(t.assoc,n),s.onChangeCallback(t.offset,i,n)),t.removeEventListener("keydown",r.keydown),t.removeEventListener("blur",r.blur)}},d=function(t){var e=t.value[0],n=ASCIIToHexpair(e);t=t.parentNode;var i=s.nav.reportChange(t.assoc.offset,n);t.innerHTML=e,t.assoc.innerHTML=n,null!==i&&(t.classList.add("modified"),t.assoc.classList.add("modified"),s.colorizeByte(t,e),s.colorizeByte(t.assoc,e),s.onChangeCallback(t.assoc.offset,t.assoc.innerHTML,n)),t.removeEventListener("keydown",l.keydown),t.removeEventListener("blur",l.blur)},u=0;u<n.length;u++){var p=o+u,f=this.nav.hasNewValue(p),m=this.nav.isModifiedByte(p);null!==f&&(n[u]=f,i[u]=hexPairToASCII(f),
m=!0);var h=document.createElement("li");h.appendChild(document.createTextNode(n[u])),h.offset=p,m&&h.classList.add("modified");var g=document.createElement("li");g.appendChild(document.createTextNode(i[u])),m&&g.classList.add("modified"),g.assoc=h,h.assoc=g,t.appendChild(h),e.appendChild(g),this.colorizeByte(h,n[u]),this.colorizeByte(g,n[u]),h.addEventListener("mouseenter",function(t){s.showPairs_(t.target,t.target.assoc,!0)}),h.addEventListener("mouseleave",function(t){s.showPairs_(t.target,t.target.assoc,!1)}),g.addEventListener("mouseenter",function(t){s.showPairs_(t.target,t.target.assoc,!0)}),g.addEventListener("mouseleave",function(t){s.showPairs_(t.target,t.target.assoc,!1)}),this.isWritable()?(h.addEventListener("click",function(t){if(0===t.button){t.preventDefault();var e=document.createElement("input");e.maxLength=2,e.initValue=t.target.innerHTML,e.value=t.target.innerHTML,e.pattern="[a-fA-F0-9]{2}",t.target.innerHTML="",t.target.appendChild(e),e.busy=!1,e.addEventListener("keydown",r.keydown),e.addEventListener("blur",r.blur),e.focus()}}),g.addEventListener("click",function(t){if(0===t.button){t.preventDefault();var e=document.createElement("input");e.maxLength=1,e.value=t.target.innerHTML,e.pattern="(.){1}",t.target.innerHTML="",t.target.appendChild(e),e.addEventListener("keydown",l.keydown),e.addEventListener("blur",l.blur),e.focus()}})):(h.addEventListener("click",function(){s.beingSelected=!1,s.cleanSelection()}),h.addEventListener("mousedown",function(t){0===t.button&&(t.preventDefault(),s.beingSelected=!0,s.selectionFirst=t.target)}),h.addEventListener("mouseover",function(t){s.beingSelected&&(s.selectionEnd=t.target,s.processSelection(!0))}),h.addEventListener("mouseup",function(t){s.beingSelected&&(s.selectionEnd=t.target,s.processSelection(!1),s.beingSelected=!1)}))}},HexPairNavigator.prototype=new BlockNavigator,HexPairNavigator.prototype.constructor=HexPairNavigator,HexPairNavigator.prototype.changeNbCols=function(t){this.providerWorker.postMessage({howManyBytes:this.howManyBytes,nbCols:t,reset:!0}),this.reset()},HexPairNavigator.prototype.reportChange=function(t,e){this.smallModifications.push({offset:t,value:e}),r2.cmd("wx "+e+" @"+t,function(){})},HexPairNavigator.prototype.hasNewValue=function(t){for(var e=0;e<this.smallModifications.length;e++)if(this.smallModifications[e].offset===t)return this.smallModifications[e].value;return null},HexPairNavigator.prototype.updateModifications=function(){var t=this;this.smallModifications=[],this.modifiedBytes=[],r2.cmd("wcj",function(e){for(var e=JSON.parse(e),n=0;n<e.length;n++)for(var i=e[n].addr,a=0;a<e[n].size;a++)t.modifiedBytes.push(i+a)})},HexPairNavigator.prototype.isModifiedByte=function(t){return this.modifiedBytes.indexOf(t)>-1},HexPairNavigator.prototype.getFlags=function(t,e){var n=function(e){for(var n=[],i=0;i<e.length;i++)e[i].size>=t&&n.push({name:e[i].name,start:e[i].offset,end:e[i].offset+e[i].size});return n.sort(function(t,e){return t.size>e.size?-1:1}),n},i=[],a=0,o=function(){a++,a<3||e(n(i))};this.get(this.Dir.CURRENT,function(t){i=i.concat(t.flags),o()}),this.get(this.Dir.BEFORE,function(t){i=i.concat(t.flags),o()}),this.get(this.Dir.AFTER,function(t){i=i.concat(t.flags),o()})},HexPairNavigator.prototype.getBytes=function(t){var e;return r2.cmdj("p8j "+(t.to-t.from+1)+" @"+t.from,function(t){e=t}),e},HexPairNavigator.prototype.refreshChunk=function(t,e){var n=[],i=this;this.get(t,function(a){a.callback=[],n=a.modified,i.get(t,function(t){t.modified.concat(n),e(t)},!0)})},HexPairNavigator.prototype.refreshCurrent=function(t){var e=0,n=function(){e++,e<3||t()};this.refreshChunk(this.Dir.CURRENT,function(){n()}),this.refreshChunk(this.Dir.BEFORE,function(){n()}),this.refreshChunk(this.Dir.AFTER,function(){n()})},FlexContainer.prototype.replug=function(t){this.container=t,this.container.innerHTML="",this.container.appendChild(this.controls),this.container.appendChild(this.body)},FlexContainer.prototype.reset=function(){this.init(this.container)},FlexContainer.prototype.init=function(t){this.container=t,this.container.innerHTML="",this.controls=document.createElement("div"),this.body=document.createElement("div"),this.controls.className="flex flex-controls "+this.classes,this.body.className="flex flex-body "+this.classes,this.container.appendChild(this.controls),this.container.appendChild(this.body)},FlexContainer.prototype.getControls=function(){return this.controls},FlexContainer.prototype.drawControls=function(t){this.controls.innerHTML="",t(this.controls)},FlexContainer.prototype.getBody=function(){return this.body},FlexContainer.prototype.drawBody=function(t){this.body.innerHTML="",t(this.body)},FlexContainer.prototype.pause=function(t){this.dialogHasBeenDrawn||this.drawEmptyDialog(),this.textDialog.innerHTML=t,this.dialog.showModal()},FlexContainer.prototype.drawEmptyDialog=function(){var t=this;this.dialog=document.createElement("dialog"),this.dialog.className="mdl-dialog",this.dialog.showModal||dialogPolyfill.registerDialog(this.dialog);var e=document.createElement("div");e.className="mdl-dialog__content",this.dialog.appendChild(e);var n=document.createElement("p");n.className="mdl-typography--text-center",e.appendChild(n);var i=document.createElement("i");i.className="material-icons",i.style.fontSize="54px",i.innerHTML="error_outline",n.appendChild(i),this.textDialog=document.createElement("p"),e.appendChild(this.textDialog);var a=document.createElement("div");a.className="mdl-dialog__actions",this.dialog.appendChild(a);var o=document.createElement("button");o.className="mdl-button",o.innerHTML="Cancel",o.addEventListener("click",function(){t.dialog.close()}),a.appendChild(o),document.body.appendChild(this.dialog),componentHandler.upgradeDom()},FlexContainer.prototype.resume=function(){this.dialog.close()},InfiniteScrolling.prototype.setTopEvent=function(t){this.ontop=t},InfiniteScrolling.prototype.setBottomEvent=function(t){this.onbottom=t},InfiniteScrolling.prototype.scrollEvent_=function(t){var e=this;if(!this.pauseScrollEvent){var n=t.target.scrollHeight-t.target.offsetHeight,i=t.target.scrollTop/n;if(!this.isTopMax&&i<this.limit&&this.prevScroll>i){this.pauseScrollEvent=!0;var a=Math.floor((this.limit+(i-this.limit)+this.screenProportion)*n);this.ontop(a,function(t){e.pauseScrollEvent=!1})}if(i>1-this.limit&&this.prevScroll<i){this.pauseScrollEvent=!0;var a=Math.floor((1-this.limit+(i-(1-this.limit))-this.screenProportion)*n);this.onbottom(a,function(t){e.pauseScrollEvent=!1})}this.prevScroll=i}};var disasm,hexdump,headersCmd={symbols:{cmd:"isq",grep:"!imp",ready:!1},imports:{cmd:"isq",grep:"imp.",ready:!1},relocs:{cmd:"ir",grep:null,ready:!1},sections:{cmd:"iSq",grep:null,ready:!1},strings:{cmd:"izq",grep:null,ready:!1},sdb:{cmd:"k bin/cur/***",grep:null,ready:!1}},infoCellHeight=-1,R2Conf={platform:{name:"platform",defVal:"x86",apply:function(t){r2.cmd("e asm.arch="+t)}},bits:{name:"bits",defVal:"32",apply:function(t){r2.cmd("e asm.bits="+t)}},utf8:{name:"utf8",defVal:"true",apply:function(t){r2.cmd("e scr.utf8="+t)}},ucase:{name:"ucase",defVal:"false",apply:function(t){r2.cmd("e asm.ucase="+t)}},describe:{name:"describe",defVal:"false",apply:function(t){r2.cmd("e asm.describe="+t)}},bytes:{name:"bytes",defVal:"false",apply:function(t){r2.cmd("e asm.bytes="+t)}},os:{name:"os",defVal:"Linux",apply:function(t){console.log("OS is now: "+t)}},size:{name:"size",defVal:"S",apply:function(t){switch(t){case"S":r2.cmd("e asm.bytes=false"),r2.cmd("e asm.lines=false"),r2.cmd("e asm.cmtright=false");break;case"M":r2.cmd("e asm.bytes=false"),r2.cmd("e asm.lines=true"),r2.cmd("e asm.lineswidth=8"),r2.cmd("e asm.cmtright=false");break;case"L":r2.cmd("e asm.bytes=true"),r2.cmd("e asm.lines=true"),r2.cmd("e asm.lineswidth=12"),r2.cmd("e asm.cmtright=true")}}},decoding:{name:"decoding",defVal:"Pseudo",apply:function(t){switch(t){case"Pseudo":r2.cmd("e asm.pseudo=1"),r2.cmd("e asm.syntax=intel");break;case"Opcodes":r2.cmd("e asm.pseudo=0"),r2.cmd("e asm.syntax=intel");break;case"ATT":r2.cmd("e asm.pseudo=0"),r2.cmd("e asm.syntax=att")}}},mode:{name:"mode",defVal:"PA",apply:function(t){switch(t){case"PA":r2.cmd("e io.va=false");break;case"VA":r2.cmd("e io.va=true");break;case"Debug":r2.cmd("e io.va=true"),r2.cmd("e io.debug=true")}}},analHasNext:{name:"analHasNext",defVal:!0,apply:function(t){console.log("analHasNext is "+t)}},analSkipNops:{name:"analSkipNops",defVal:!0,apply:function(t){console.log("analSkipNops is "+t)}},analNonCode:{name:"analNonCode",defVal:!1,apply:function(t){console.log("analNonCode is "+t)}},colors:{name:"colors",defVal:!0,apply:function(t){inColor=t,r2.cmd("e scr.color="+t)}},useTTS:{name:"tts",defVal:!0,apply:function(t){R2Conf.useTTS.value=t}},theme:{name:"theme",defVal:"none",apply:function(t){r2.cmd("eco "+t)}}};