Description: Fix check for lua libs.
 The internal pluglins Makefile is too strict on the pkgconfig check for
 lua config, so I made the hyphen optional and added a number to make
 a possible mismatch more unlikely.
Author: David Mart√≠nez Moreno <ender@debian.org>
Forwarded: no
Last-Update: 2013-12-27

--- a/libr/lang/p/Makefile
+++ b/libr/lang/p/Makefile
@@ -1,11 +1,11 @@
 BINDEPS=foo
 include ../../config.mk
 
-CFLAGS+=-I../../include -Wall -DPREFIX=\"${PREFIX}\"
+CFLAGS+=-I../../include -Wall -DPREFIX=\"${LIBDIR}\"
 ifeq ($(OSTYPE),darwin)
 CFLAGS+=-undefined dynamic_lookup
 endif
-LUAPKG=$(shell pkg-config --list-all|awk '/lua-/{print $$1;}')
+LUAPKG=$(shell pkg-config --list-all|awk '/lua-?[0-9]/{print $$1};')
 ifneq (${LUAPKG},)
 CFLAGS+=$(shell pkg-config --cflags ${LUAPKG})
 LUA_LDFLAGS+=$(shell pkg-config --libs ${LUAPKG})
@@ -57,7 +57,7 @@
 	-${CC} ${CFLAGS} -I/usr/lib/perl/5.10/CORE/ \
 		-fPIC ${LDFLAGS_LIB} -o lang_perl.${EXT_SO} perl.c ${LDFLAGS_LINKPATH}.. \
 		`perl -MExtUtils::Embed -e ccopts | sed -e 's/-arch [^\s]* //g'` \
-		`perl -MExtUtils::Embed -e ldopts | sed -e 's/-arch [^\s]* //g'` -lncurses
+		`perl -MExtUtils::Embed -e ldopts | sed -e 's/-arch [^\s]* //g'`
 
 mrproper clean:
 	-rm -f *.${EXT_SO} *.${EXT_AR} *.o
