Description: Fix a segfault in rafind2.
 The Mayhem team from CMU found with a fuzzying attack that a short hex://
 URL can make it to segfault.
Author: pancake <pancake@nopcode.org>
Origin: upstream, https://github.com/radare/radare2/commit/e0f436415f4a139da251f72e960fd12d1e1d738e
Reviewed-by: David Mart√≠nez Moreno <ender@debian.org>
Last-Update: 2013-12-28

--- a/libr/io/p/io_malloc.c
+++ b/libr/io/p/io_malloc.c
@@ -80,6 +80,10 @@
 			mal->buf = malloc (mal->size);
 			memset (mal->buf, 0, mal->size);
 			mal->size = r_hex_str2bin (pathname+6, mal->buf);
+			if ((int)mal->size<1) {
+				free (mal->buf);
+				mal->buf = NULL;
+			}
 		} else {
 			mal->size = r_num_math (NULL, pathname+9);
 			if ((mal->size)>0) {
